<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<mule-configuration xmlns="http://www.mulesoft.com/tooling/messageflow" name="mule-ucsf-admit-hospital">
    <global-unknown description="false" index="1" entity-id="global-unknown#1">
        <content>&lt;mulexml:namespace-manager xmlns:mulexml=&quot;http://www.mulesoft.org/schema/mule/xml&quot; includeConfigNamespaces=&quot;true&quot;&gt;
		&lt;mulexml:namespace prefix=&quot;hl7xml&quot; uri=&quot;urn:hl7-org:v2xml&quot;/&gt;
	&lt;/mulexml:namespace-manager&gt;</content>
    </global-unknown>
    <global-element name="Salesforce" type="http://www.mulesoft.org/schema/mule/sfdc/config" entity-id="Salesforce#1">
        <properties>
            <property name="proxyUsername"/>
            <property name="securityToken" value="${salesforce.securitytoken}"/>
            <property name="proxyHost"/>
            <property name="allowFieldTruncationSupport"/>
            <property name="auxiliary;metauseMetaData"/>
            <property name="assignmentRuleId"/>
            <property name="proxyPort"/>
            <property name="password" value="${salesforce.password}"/>
            <property name="clientId"/>
            <property name="url" value="${salesforce.endpoint}"/>
            <property name="username" value="${salesforce.username}"/>
            <property name="useDefaultRule"/>
            <property name="name" value="UCSF_SF_Connection"/>
            <property name="timeObjectStore-ref"/>
            <property name="auxiliary;index" value="3"/>
            <property name="proxyPassword"/>
            <property-collection name="@http://www.mulesoft.org/schema/mule/sfdc/connection-pooling-profile;0">
                <property name="maxActive" value="10"/>
                <property name="exhaustedAction" value="WHEN_EXHAUSTED_GROW"/>
                <property name="maxIdle" value="10"/>
                <property name="maxWait" value="120"/>
                <property name="evictionCheckIntervalMillis" value="30000"/>
                <property name="minEvictionMillis" value="60000"/>
                <property name="auxiliary;index" value="4"/>
                <property name="auxiliary;wrapIn" value="4"/>
                <property name="initialisationPolicy" value="INITIALISE_ONE"/>
            </property-collection>
            <property-collection name="@http://www.mulesoft.org/schema/mule/core/reconnect;0">
                <property name="count" value="50"/>
                <property name="frequency" value="10000"/>
                <property name="auxiliary;index" value="5"/>
                <property name="auxiliary;wrapIn" value="5"/>
            </property-collection>
        </properties>
    </global-element>
    <global-element name="HL7 Connector" type="http://www.mulesoft.org/schema/mule/hl7/connector" entity-id="HL7 Connector#1">
        <properties>
            <property name="reuseAddress"/>
            <property name="receiveBacklog"/>
            <property name="validation"/>
            <property name="serverSoTimeout"/>
            <property name="socketSoLinger"/>
            <property name="clientSoTimeout"/>
            <property name="validateConnections"/>
            <property name="keepAlive"/>
            <property name="sendTcpNoDelay"/>
            <property name="hl7Encoding"/>
            <property name="dispatcherPoolFactory-ref"/>
            <property name="receiveBufferSize"/>
            <property name="name" value="hl7"/>
            <property name="keepSendSocketOpen"/>
            <property name="dynamicNotification"/>
            <property name="sendBufferSize"/>
            <property name="auxiliary;index" value="6"/>
        </properties>
    </global-element>
    <global-element name="DataMapper" type="http://www.mulesoft.org/schema/mule/ee/data-mapper/config" entity-id="DataMapper#1">
        <properties>
            <property name="name" value="a01xml2pv1-2.4_grf"/>
            <property name="auxiliary;index" value="8"/>
            <property name="transformationGraphPath" value="a01xml2pv1-2.4.grf"/>
        </properties>
    </global-element>
    <global-element name="DataMapper" type="http://www.mulesoft.org/schema/mule/ee/data-mapper/config" entity-id="DataMapper#2">
        <properties>
            <property name="name" value="mapvisitrole_grf"/>
            <property name="auxiliary;index" value="9"/>
            <property name="transformationGraphPath" value="mapvisitrole.grf"/>
        </properties>
    </global-element>
    <global-element name="DataMapper" type="http://www.mulesoft.org/schema/mule/ee/data-mapper/config" entity-id="DataMapper#3">
        <properties>
            <property name="name" value="a01map2map_grf"/>
            <property name="auxiliary;index" value="10"/>
            <property name="transformationGraphPath" value="a01map2map.grf"/>
        </properties>
    </global-element>
    <global-element name="DataMapper" type="http://www.mulesoft.org/schema/mule/ee/data-mapper/config" entity-id="DataMapper#4">
        <properties>
            <property name="name" value="a01xml2pv1_2_4_grf"/>
            <property name="auxiliary;index" value="11"/>
            <property name="transformationGraphPath" value="a01xml2pv1-2.4.grf"/>
        </properties>
    </global-element>
    <global-element name="DataMapper" type="http://www.mulesoft.org/schema/mule/ee/data-mapper/config" entity-id="DataMapper#5">
        <properties>
            <property name="name" value="maproletoobject_grf"/>
            <property name="auxiliary;index" value="12"/>
            <property name="transformationGraphPath" value="maproletoobject.grf"/>
        </properties>
    </global-element>
    <global-element name="DataMapper" type="http://www.mulesoft.org/schema/mule/ee/data-mapper/config" entity-id="DataMapper#6">
        <properties>
            <property name="name" value="mappatient_1_grf"/>
            <property name="auxiliary;index" value="13"/>
            <property name="transformationGraphPath" value="mappatient_1.grf"/>
        </properties>
    </global-element>
    <global-element name="DataMapper" type="http://www.mulesoft.org/schema/mule/ee/data-mapper/config" entity-id="DataMapper#7">
        <properties>
            <property name="name" value="mapproletosalesforceobject_grf"/>
            <property name="auxiliary;index" value="14"/>
            <property name="transformationGraphPath" value="mapproletosalesforceobject.grf"/>
        </properties>
    </global-element>
    <global-element name="SMTP" type="http://www.mulesoft.org/schema/mule/smtps/connector" entity-id="SMTP#1">
        <properties>
            <property name="dispatcherPoolFactory-ref"/>
            <property name="subject"/>
            <property name="name" value="smtpsGmailConnector"/>
            <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/smtps/connector"/>
            <property name="fromAddress" value="ucsfmule@gmail.com"/>
            <property name="bccAddresses"/>
            <property name="validateConnections"/>
            <property name="dynamicNotification"/>
            <property name="contentType"/>
            <property name="replyToAddresses"/>
            <property name="auxiliary;index" value="15"/>
            <property name="ccAddresses" value="${mail.touser}"/>
            <property-collection name="@http://www.mulesoft.org/schema/mule/smtps/tls-client;0">
                <property name="path" value="/etc/mule/somvs108.ucsf.edu.keystore.jks.new"/>
                <property name="storePassword" value="${server.keystorepassword}"/>
                <property name="auxiliary;index" value="19"/>
                <property name="auxiliary;wrapIn" value="19"/>
            </property-collection>
            <property-collection name="@http://www.mulesoft.org/schema/mule/smtps/tls-trust-store;0">
                <property name="path" value="greenmail-truststore"/>
                <property name="storePassword" value="${server.keystorepassword}"/>
                <property name="auxiliary;index" value="20"/>
                <property name="auxiliary;wrapIn" value="20"/>
            </property-collection>
        </properties>
    </global-element>
    <global-element name="Configuration" type="http://www.mulesoft.org/schema/mule/core/configuration" entity-id="Configuration#1">
        <properties>
            <property name="defaultExceptionStrategy-ref" value="Global_Catch_Exception_Strategy"/>
            <property name="auxiliary;index" value="21"/>
        </properties>
    </global-element>
    <global-element name="Catch Exception Strategy" type="http://www.mulesoft.org/schema/mule/core/catch-exception-strategy" entity-id="Catch Exception Strategy#1">
        <properties>
            <property name=""/>
            <property name="when"/>
            <property name="name" value="Global_Catch_Exception_Strategy"/>
            <property name="enableNotifications"/>
            <property name="auxiliary;index" value="22"/>
        </properties>
        <compartment>
            <lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#1">
                <scope name="Message Enricher" type="org.mule.tooling.ui.modules.core.scope.enricher" entity-id="Message Enricher#1">
                    <graphicalData x="0" y="0" width="0" height="0"/>
                    <properties>
                        <property name="source"/>
                        <property name="target" value="variable:dummy1"/>
                        <property name="auxiliary;index" value="23"/>
                    </properties>
                    <compartment entity-id="compartment#1">
                        <lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#2">
                            <scope name="Processor Chain" type="http://www.mulesoft.org/schema/mule/core/processor-chain" entity-id="Processor Chain#1">
<graphicalData x="0" y="0" width="0" height="0"/>
<properties>
    <property name="auxiliary;index" value="24"/>
</properties>
<compartment entity-id="compartment#2">
    <lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#3">
        <pattern name="Set Payload ERror" type="http://www.mulesoft.org/schema/mule/core/set-payload" entity-id="Set Payload#1">
            <graphicalData x="0" y="0" width="0" height="0"/>
            <properties>
                <property name="value" value="Error processing HL7 document #[exception]"/>
                <property name="auxiliary;index" value="25"/>
            </properties>
        </pattern>
        <pattern name="Flow Reference" type="http://www.mulesoft.org/schema/mule/core/flow-ref" entity-id="Flow Reference#1">
            <graphicalData x="0" y="0" width="0" height="0"/>
            <properties>
                <property name="name" value="sendemail"/>
                <property name="auxiliary;index" value="26"/>
            </properties>
        </pattern>
    </lane>
</compartment>
                            </scope>
                        </lane>
                    </compartment>
                </scope>
            </lane>
        </compartment>
    </global-element>
    <global-element name="Byte Array to String" type="http://www.mulesoft.org/schema/mule/core/byte-array-to-string-transformer" entity-id="Byte Array to String#1">
        <properties>
            <property name="returnClass"/>
            <property name="ignoreBadInput"/>
            <property name="name" value="Byte_Array_to_StringForTCP"/>
            <property name="encoding"/>
            <property name="mimeType"/>
            <property name="auxiliary;index" value="27"/>
        </properties>
    </global-element>
    <global-element name="DataMapper" type="http://www.mulesoft.org/schema/mule/ee/data-mapper/config" entity-id="DataMapper#8">
        <properties>
            <property name="name" value="attendingphysician_grf"/>
            <property name="auxiliary;index" value="28"/>
            <property name="transformationGraphPath" value="attendingphysician.grf"/>
        </properties>
    </global-element>
    <flow SubFlow="false" name="ErrorHandlingFlow" entity-id="76d8584c-d6c1-42d0-ad2a-385cfcac6486">
        <properties>
            <property name="processingStrategy"/>
            <property name="processingStrategy2"/>
            <property name="bussinessEventsLabel"/>
            <property name="tracking:enable-default-events"/>
            <property name="auxiliary;index" value="29"/>
        </properties>
        <lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#4">
            <graphicalData x="0" y="0" width="0" height="0"/>
            <endpoint direction="Inbound" message-exchange-pattern="OneWay" name="VM" type="http://www.mulesoft.org/schema/mule/vm/endpoint" entity-id="VM#1">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="businessEventsLabel"/>
                    <property name="disableTransportTransformer"/>
                    <property name="exchange-pattern"/>
                    <property name="tracking:enable-default-events"/>
                    <property name="ref"/>
                    <property name="transformer-refs"/>
                    <property name="address"/>
                    <property name="path" value="DeadLetterQueue"/>
                    <property name="encoding"/>
                    <property name="responseTransformer-refs"/>
                    <property name="auxiliary;index" value="30"/>
                    <property name="responseTimeout"/>
                    <property name="mimeType"/>
                    <property name="connector-ref"/>
                </properties>
            </endpoint>
            <pattern name="Logger" type="http://www.mulesoft.org/schema/mule/core/logger" entity-id="Logger#1">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="message"/>
                    <property name="category" value="com.ucsf.events"/>
                    <property name="level" value="ERROR"/>
                    <property name="auxiliary;index" value="31"/>
                </properties>
            </pattern>
            <pattern name="Flow Reference" type="http://www.mulesoft.org/schema/mule/core/flow-ref" entity-id="Flow Reference#2">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="name" value="undoProcessing"/>
                    <property name="auxiliary;index" value="32"/>
                </properties>
            </pattern>
        </lane>
    </flow>
    <flow SubFlow="true" name="undoProcessing" entity-id="4b2f1625-1056-441b-8c23-8d19ff389e88">
        <properties>
            <property name="processingStrategy"/>
            <property name="processingStrategy2"/>
            <property name="bussinessEventsLabel"/>
            <property name="tracking:enable-default-events"/>
            <property name="auxiliary;index" value="33"/>
        </properties>
        <lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#5">
            <graphicalData x="0" y="0" width="0" height="0"/>
            <pattern name="Logger" type="http://www.mulesoft.org/schema/mule/core/logger" entity-id="Logger#2">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="message" value="Undoing operations"/>
                    <property name="category"/>
                    <property name="level" value="ERROR"/>
                    <property name="auxiliary;index" value="34"/>
                </properties>
            </pattern>
        </lane>
    </flow>
    <flow SubFlow="false" name="mule-ucsf-pocFlow1" entity-id="3b0bbe1c-ac30-430c-982a-f4b0ed4e9bc1">
        <properties>
            <property name="processingStrategy" value="synchronous"/>
            <property name="processingStrategy2" value="synchronous"/>
            <property name="bussinessEventsLabel"/>
            <property name="tracking:enable-default-events"/>
            <property name="auxiliary;index" value="35"/>
        </properties>
        <lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#6">
            <graphicalData x="0" y="0" width="0" height="0"/>
            <multi-source index="0" name="Composite Source" type="http://www.mulesoft.org/schema/mule/core/composite-source" entity-id="Composite Source#1">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="auxiliary;index" value="36"/>
                </properties>
                <endpoint direction="Inbound" message-exchange-pattern="RequestResponse" name="Receive HL7 message" type="http://www.mulesoft.org/schema/mule/tcp/endpoint" entity-id="TCP#1">
                    <graphicalData x="0" y="0" width="0" height="0"/>
                    <properties>
                        <property name="port" value="8062"/>
                        <property name="host" value="0.0.0.0"/>
                        <property name="businessEventsLabel"/>
                        <property name="disableTransportTransformer"/>
                        <property name="exchange-pattern" value="request-response"/>
                        <property name="tracking:enable-default-events"/>
                        <property name="ref"/>
                        <property name="transformer-refs" value="Byte_Array_to_StringForTCP"/>
                        <property name="address"/>
                        <property name="encoding"/>
                        <property name="responseTransformer-refs"/>
                        <property name="auxiliary;index" value="37"/>
                        <property name="responseTimeout" value="1000000"/>
                        <property name="mimeType"/>
                        <property name="connector-ref"/>
                    </properties>
                </endpoint>
                <endpoint direction="Inbound" message-exchange-pattern="RequestResponse" name="HL7 MLLP" type="http://www.mulesoft.org/schema/mule/hl7/endpoint" entity-id="HL7 MLLP#1">
                    <graphicalData x="0" y="0" width="0" height="0"/>
                    <properties>
                        <property name="port" value="8061"/>
                        <property name="host" value="0.0.0.0"/>
                        <property name="businessEventsLabel"/>
                        <property name="disableTransportTransformer"/>
                        <property name="exchange-pattern"/>
                        <property name="tracking:enable-default-events"/>
                        <property name="ref"/>
                        <property name="transformer-refs"/>
                        <property name="address"/>
                        <property name="encoding"/>
                        <property name="responseTransformer-refs"/>
                        <property name="auxiliary;index" value="38"/>
                        <property name="responseTimeout"/>
                        <property name="mimeType"/>
                        <property name="connector-ref"/>
                    </properties>
                </endpoint>
            </multi-source>
            <pattern name="Logger" type="http://www.mulesoft.org/schema/mule/core/logger" entity-id="Logger#3">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="message" value="passing request to VM"/>
                    <property name="category"/>
                    <property name="level" value="INFO"/>
                    <property name="auxiliary;index" value="39"/>
                </properties>
            </pattern>
            <unknown description="false" index="40" entity-id="unknown#1">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <content>&lt;request-reply xmlns=&quot;http://www.mulesoft.org/schema/mule/core&quot; storePrefix=&quot;mainFlow&quot;&gt;
				&lt;vm:outbound-endpoint xmlns:vm=&quot;http://www.mulesoft.org/schema/mule/vm&quot; path=&quot;processhl7vm&quot;&gt; 
			 		 &lt;message-properties-transformer scope=&quot;outbound&quot;&gt;
            		 &lt;delete-message-property key=&quot;MULE_REPLYTO&quot;/&gt;
       				 &lt;/message-properties-transformer&gt;
    			&lt;/vm:outbound-endpoint&gt;
	
			&lt;vm:inbound-endpoint xmlns:vm=&quot;http://www.mulesoft.org/schema/mule/vm&quot; path=&quot;reply&quot;/&gt; 
    	 &lt;/request-reply&gt;</content>
            </unknown>
            <pattern name="Logger" type="http://www.mulesoft.org/schema/mule/core/logger" entity-id="Logger#4">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="message" value="Finished flow .Payload #[payload:]"/>
                    <property name="category"/>
                    <property name="level" value="INFO"/>
                    <property name="auxiliary;index" value="45"/>
                </properties>
            </pattern>
        </lane>
    </flow>
    <flow SubFlow="true" name="mule-ucsf-insert-patient" entity-id="3a359415-997b-4b85-a8a3-6a6c2a53b8e6">
        <properties>
            <property name="processingStrategy"/>
            <property name="processingStrategy2"/>
            <property name="bussinessEventsLabel"/>
            <property name="tracking:enable-default-events"/>
            <property name="auxiliary;index" value="46"/>
        </properties>
        <lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#7">
            <graphicalData x="0" y="0" width="0" height="0"/>
            <scope name="Message Enricher" type="org.mule.tooling.ui.modules.core.scope.enricher" entity-id="Message Enricher#2">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="source"/>
                    <property name="target"/>
                    <property name="auxiliary;index" value="47"/>
                    <property-collection name="@http://www.mulesoft.org/schema/mule/core/enrich;0">
                        <property name="source" value="#[flowVars.?PCPNO1]"/>
                        <property name="target" value="#[flowVars['PCPNO1']]"/>
                        <property name="auxiliary;index" value="65"/>
                        <property name="auxiliary;wrapIn" value="65"/>
                    </property-collection>
                    <property-collection name="@http://www.mulesoft.org/schema/mule/core/enrich;1">
                        <property name="source" value="#[flowVars.?PCPNO2]"/>
                        <property name="target" value="#[flowVars['PCPNO2']]"/>
                        <property name="auxiliary;index" value="66"/>
                        <property name="auxiliary;wrapIn" value="66"/>
                    </property-collection>
                    <property-collection name="@http://www.mulesoft.org/schema/mule/core/enrich;2">
                        <property name="source" value="#[flowVars.?pId]"/>
                        <property name="target" value="#[flowVars['pId']]"/>
                        <property name="auxiliary;index" value="67"/>
                        <property name="auxiliary;wrapIn" value="67"/>
                    </property-collection>
                    <property-collection name="@http://www.mulesoft.org/schema/mule/core/enrich;3">
                        <property name="source" value="#[flowVars.?savedPatient]"/>
                        <property name="target" value="#[flowVars['savedPatient']]"/>
                        <property name="auxiliary;index" value="68"/>
                        <property name="auxiliary;wrapIn" value="68"/>
                    </property-collection>
                    <property-collection name="@http://www.mulesoft.org/schema/mule/core/enrich;4">
                        <property name="source" value="#[flowVars.?mappedPatient]"/>
                        <property name="target" value="#[flowVars['mappedPatient']]"/>
                        <property name="auxiliary;index" value="69"/>
                        <property name="auxiliary;wrapIn" value="69"/>
                    </property-collection>
                </properties>
                <compartment entity-id="compartment#3">
                    <lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#8">
                        <scope name="Processor Chain" type="http://www.mulesoft.org/schema/mule/core/processor-chain" entity-id="Processor Chain#2">
                            <graphicalData x="0" y="0" width="0" height="0"/>
                            <properties>
<property name="auxiliary;index" value="48"/>
                            </properties>
                            <compartment entity-id="compartment#4">
<lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#9">
    <pattern name="Byte Array to String" type="http://www.mulesoft.org/schema/mule/core/byte-array-to-string-transformer" entity-id="Byte Array to String#2">
        <graphicalData x="0" y="0" width="0" height="0"/>
        <properties>
            <property name="returnClass"/>
            <property name="ignoreBadInput"/>
            <property name="encoding"/>
            <property name="mimeType"/>
            <property name="auxiliary;index" value="49"/>
        </properties>
    </pattern>
    <pattern name="DataMapper" type="http://www.mulesoft.org/schema/mule/ee/data-mapper/data-mapper-connector" entity-id="DataMapper#9">
        <graphicalData x="0" y="0" width="0" height="0"/>
        <properties>
            <property name="returnClass"/>
            <property name="stream"/>
            <property name="input-ref"/>
            <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/ee/data-mapper/transform"/>
            <property name="pipeSize"/>
            <property name="config-ref" value="mappatient_1_grf"/>
            <property name="auxiliary;index" value="50"/>
        </properties>
    </pattern>
    <pattern name="Logger" type="http://www.mulesoft.org/schema/mule/core/logger" entity-id="Logger#5">
        <graphicalData x="0" y="0" width="0" height="0"/>
        <properties>
            <property name="message" value="-------#[payload:]"/>
            <property name="category"/>
            <property name="level" value="DEBUG"/>
            <property name="auxiliary;index" value="51"/>
        </properties>
    </pattern>
    <pattern name="Set Variable" type="http://www.mulesoft.org/schema/mule/core/variable-transformer" entity-id="Variable#1">
        <graphicalData x="0" y="0" width="0" height="0"/>
        <properties>
            <property name="variableName" value="mappedPatient"/>
            <property name="value" value="#[payload]"/>
            <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/core/set-variable"/>
            <property name="auxiliary;index" value="52"/>
        </properties>
    </pattern>
    <scope name="Insert Update Patient" type="http://www.mulesoft.org/schema/mule/core/processor-chain" entity-id="Processor Chain#3">
        <graphicalData x="0" y="0" width="0" height="0"/>
        <properties>
            <property name="auxiliary;index" value="53"/>
        </properties>
        <compartment entity-id="compartment#5">
            <lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#10">
                <pattern name="Lookup Patient" type="http://www.mulesoft.org/schema/mule/sfdc/sfdc-connector" entity-id="Salesforce#2">
                    <graphicalData x="0" y="0" width="0" height="0"/>
                    <properties>
                        <property name=""/>
                        <property name="proxyUsername"/>
                        <property name="securityToken"/>
                        <property name="proxyHost"/>
                        <property name="query" value="SELECT mp.Id,Gender__c,Middle_Name__c, MRN_Number__c, Last_Name__c FROM ADT_Patient__c mp WHERE mp.MRN_Number__c='#[payload[0].MRN_Number__c]'"/>
                        <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/sfdc/query"/>
                        <property name="proxyPort"/>
                        <property name="password"/>
                        <property name="url"/>
                        <property name="username"/>
                        <property name="accessTokenId"/>
                        <property name="config-ref" value="UCSF_SF_Connection"/>
                        <property name="auxiliary;index" value="54"/>
                        <property name="proxyPassword"/>
                    </properties>
                </pattern>
                <splitter index="55" name="Choice" type="org.mule.tooling.ui.modules.core.pattern.cbr" entity-id="Choice#1">
                    <graphicalData x="0" y="0" width="0" height="0"/>
                    <properties>
                        <property-collection name="1e278886-f0c9-486f-a61e-eb363f461d87">
                            <property name="choice.otherwise" value="true"/>
                            <property-collection name="choice.attributes"/>
                        </property-collection>
                        <property-collection name="6952cf44-7049-43b1-9dc3-fc45c290b358">
                            <property name="choice.expression" value="#[groovy:payload.size() == 0]"/>
                            <property-collection name="choice.attributes">
<property name="expression" value="#[groovy:payload.size() == 0]"/>
                            </property-collection>
                        </property-collection>
                    </properties>
                    <pattern name="Choice" type="org.mule.tooling.ui.modules.core.pattern.cbr" entity-id="Choice#2"/>
                    <compartment entity-id="compartment#6">
                        <lane hadOnlyOneElement="false" index="57" isChoiceOtherwiseLane="false" entity-id="6952cf44-7049-43b1-9dc3-fc45c290b358">
                            <pattern name="Insert Patient" type="http://www.mulesoft.org/schema/mule/sfdc/sfdc-connector" entity-id="Salesforce#3">
<graphicalData x="0" y="0" width="0" height="0"/>
<properties>
    <property name=""/>
    <property name="proxyUsername"/>
    <property name="securityToken"/>
    <property name="proxyHost"/>
    <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/sfdc/create"/>
    <property name="proxyPort"/>
    <property name="type" value="ADT_Patient__c"/>
    <property name="password"/>
    <property name="url"/>
    <property name="username"/>
    <property name="accessTokenId"/>
    <property name="config-ref" value="UCSF_SF_Connection"/>
    <property name="auxiliary;index" value="57"/>
    <property name="proxyPassword"/>
    <property-collection name="@http://www.mulesoft.org/schema/mule/sfdc/create-objectss;0">
        <property name="ref" value="#[flowVars['mappedPatient']]"/>
        <property name="auxiliary;index" value="58"/>
        <property name="auxiliary;wrapIn" value="58"/>
    </property-collection>
</properties>
                            </pattern>
                        </lane>
                        <lane hadOnlyOneElement="false" index="60" isChoiceOtherwiseLane="true" entity-id="1e278886-f0c9-486f-a61e-eb363f461d87">
                            <pattern name="Variable" type="http://www.mulesoft.org/schema/mule/core/variable-transformer" entity-id="Variable#2">
<graphicalData x="0" y="0" width="0" height="0"/>
<properties>
    <property name="variableName" value="savedPatient"/>
    <property name="value" value="#[payload[0]]"/>
    <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/core/set-variable"/>
    <property name="auxiliary;index" value="60"/>
</properties>
                            </pattern>
                            <pattern name="Upsert Patient" type="http://www.mulesoft.org/schema/mule/sfdc/sfdc-connector" entity-id="Salesforce#4">
<graphicalData x="0" y="0" width="0" height="0"/>
<properties>
    <property name=""/>
    <property name="proxyUsername"/>
    <property name="securityToken"/>
    <property name="proxyHost"/>
    <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/sfdc/upsert"/>
    <property name="proxyPort"/>
    <property name="type" value="ADT_Patient__c"/>
    <property name="password"/>
    <property name="url"/>
    <property name="externalIdFieldName" value="MRN_Number__c"/>
    <property name="username"/>
    <property name="accessTokenId"/>
    <property name="config-ref" value="UCSF_SF_Connection"/>
    <property name="proxyPassword"/>
    <property name="auxiliary;index" value="61"/>
    <property-collection name="@http://www.mulesoft.org/schema/mule/sfdc/upsert-objectss;0">
        <property name="ref" value="#[flowVars['mappedPatient']]"/>
        <property name="auxiliary;index" value="62"/>
        <property name="auxiliary;wrapIn" value="62"/>
    </property-collection>
</properties>
                            </pattern>
                        </lane>
                    </compartment>
                </splitter>
            </lane>
        </compartment>
    </scope>
    <pattern name="Set Patient Id" type="http://www.mulesoft.org/schema/mule/core/variable-transformer" entity-id="Variable#3">
        <graphicalData x="0" y="0" width="0" height="0"/>
        <properties>
            <property name="variableName" value="pId"/>
            <property name="value" value="#[payload[0].Id]"/>
            <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/core/set-variable"/>
            <property name="auxiliary;index" value="63"/>
        </properties>
    </pattern>
    <pattern name="SFDC Lookup Output" type="http://www.mulesoft.org/schema/mule/core/logger" entity-id="Logger#6">
        <graphicalData x="0" y="0" width="0" height="0"/>
        <properties>
            <property name="message" value="&quot;log SFDC Final Return payload&quot; + #[payload]"/>
            <property name="category"/>
            <property name="level" value="INFO"/>
            <property name="auxiliary;index" value="64"/>
        </properties>
    </pattern>
</lane>
                            </compartment>
                        </scope>
                    </lane>
                </compartment>
            </scope>
            <scope name="Message Enricher" type="org.mule.tooling.ui.modules.core.scope.enricher" entity-id="Message Enricher#3">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="source"/>
                    <property name="target"/>
                    <property name="auxiliary;index" value="70"/>
                    <property-collection name="@http://www.mulesoft.org/schema/mule/core/enrich;0">
                        <property name="source" value="#[flowVars.?savedPatientVisit]"/>
                        <property name="target" value="#[flowVars['savedPatientVisit']]"/>
                        <property name="auxiliary;index" value="72"/>
                        <property name="auxiliary;wrapIn" value="72"/>
                    </property-collection>
                    <property-collection name="@http://www.mulesoft.org/schema/mule/core/enrich;1">
                        <property name="source" value="#[flowVars.?saveInpatientRoles]"/>
                        <property name="target" value="#[flowVars['saveInpatientRoles']]"/>
                        <property name="auxiliary;index" value="73"/>
                        <property name="auxiliary;wrapIn" value="73"/>
                    </property-collection>
                    <property-collection name="@http://www.mulesoft.org/schema/mule/core/enrich;2">
                        <property name="source" value="#[flowVars.?pVisitId]"/>
                        <property name="target" value="#[flowVars['pVisitId']]"/>
                        <property name="auxiliary;index" value="74"/>
                        <property name="auxiliary;wrapIn" value="74"/>
                    </property-collection>
                </properties>
                <compartment entity-id="compartment#7">
                    <lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#11">
                        <pattern name="Insert Patient Visit Flow" type="http://www.mulesoft.org/schema/mule/core/flow-ref" entity-id="Flow Reference#3">
                            <graphicalData x="0" y="0" width="0" height="0"/>
                            <properties>
<property name="name" value="mule-ucsf-insert-patientVisit"/>
<property name="auxiliary;index" value="71"/>
                            </properties>
                        </pattern>
                    </lane>
                </compartment>
            </scope>
            <pattern name="Variable" type="http://www.mulesoft.org/schema/mule/core/variable-transformer" entity-id="Variable#4">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="variableName" value="roletype"/>
                    <property name="value" value="outpatient"/>
                    <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/core/set-variable"/>
                    <property name="auxiliary;index" value="75"/>
                </properties>
            </pattern>
            <scope name="Message Enricher" type="org.mule.tooling.ui.modules.core.scope.enricher" entity-id="Message Enricher#4">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="source"/>
                    <property name="target"/>
                    <property name="auxiliary;index" value="76"/>
                    <property-collection name="@http://www.mulesoft.org/schema/mule/core/enrich;0">
                        <property name="source" value="#[flowVars.?saveRoles]"/>
                        <property name="target" value="#[flowVars['outpatientRoles']]"/>
                        <property name="auxiliary;index" value="78"/>
                        <property name="auxiliary;wrapIn" value="78"/>
                    </property-collection>
                </properties>
                <compartment entity-id="compartment#8">
                    <lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#12">
                        <pattern name="Insert Patient Visit Role Flow" type="http://www.mulesoft.org/schema/mule/core/flow-ref" entity-id="Flow Reference#4">
                            <graphicalData x="0" y="0" width="0" height="0"/>
                            <properties>
<property name="name" value="mule-ucsf-insert-role"/>
<property name="auxiliary;index" value="77"/>
                            </properties>
                        </pattern>
                    </lane>
                </compartment>
            </scope>
        </lane>
    </flow>
    <flow SubFlow="true" name="mule-ucsf-insert-patientVisit" entity-id="41a1f240-fee3-428e-8aab-40c380dddd35">
        <properties>
            <property name="processingStrategy"/>
            <property name="processingStrategy2"/>
            <property name="bussinessEventsLabel"/>
            <property name="tracking:enable-default-events"/>
            <property name="auxiliary;index" value="79"/>
        </properties>
        <lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#13">
            <graphicalData x="0" y="0" width="0" height="0"/>
            <scope name="Message Enricher" type="org.mule.tooling.ui.modules.core.scope.enricher" entity-id="Message Enricher#5">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="source"/>
                    <property name="target"/>
                    <property name="auxiliary;index" value="80"/>
                    <property-collection name="@http://www.mulesoft.org/schema/mule/core/enrich;0">
                        <property name="source" value="#[flowVars.?savedPatientVisit]"/>
                        <property name="target" value="#[flowVars['savedPatientVisit']]"/>
                        <property name="auxiliary;index" value="104"/>
                        <property name="auxiliary;wrapIn" value="104"/>
                    </property-collection>
                    <property-collection name="@http://www.mulesoft.org/schema/mule/core/enrich;1">
                        <property name="source" value="#[flowVars.?savedAttending]"/>
                        <property name="target" value="#[flowVars['savedAttending']]"/>
                        <property name="auxiliary;index" value="105"/>
                        <property name="auxiliary;wrapIn" value="105"/>
                    </property-collection>
                    <property-collection name="@http://www.mulesoft.org/schema/mule/core/enrich;2">
                        <property name="source" value="#[flowVars.?pVisitId]"/>
                        <property name="target" value="#[flowVars['pVisitId']]"/>
                        <property name="auxiliary;index" value="106"/>
                        <property name="auxiliary;wrapIn" value="106"/>
                    </property-collection>
                </properties>
                <compartment entity-id="compartment#9">
                    <lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#14">
                        <scope name="Processor Chain" type="http://www.mulesoft.org/schema/mule/core/processor-chain" entity-id="Processor Chain#4">
                            <graphicalData x="0" y="0" width="0" height="0"/>
                            <properties>
<property name="auxiliary;index" value="81"/>
                            </properties>
                            <compartment entity-id="compartment#10">
<lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#15">
    <pattern name="Log SF Payload" type="http://www.mulesoft.org/schema/mule/core/logger" entity-id="Logger#7">
        <graphicalData x="0" y="0" width="0" height="0"/>
        <properties>
            <property name="message" value="Log In PatientVisit Flow - #[pId]"/>
            <property name="category"/>
            <property name="level" value="INFO"/>
            <property name="auxiliary;index" value="82"/>
        </properties>
    </pattern>
    <pattern name="Byte Array to String" type="http://www.mulesoft.org/schema/mule/core/byte-array-to-string-transformer" entity-id="Byte Array to String#3">
        <graphicalData x="0" y="0" width="0" height="0"/>
        <properties>
            <property name="returnClass"/>
            <property name="ignoreBadInput"/>
            <property name="encoding"/>
            <property name="mimeType"/>
            <property name="auxiliary;index" value="83"/>
        </properties>
    </pattern>
    <pattern name="Transform A01 to Patient Visit" type="http://www.mulesoft.org/schema/mule/ee/data-mapper/data-mapper-connector" entity-id="DataMapper#10">
        <graphicalData x="0" y="0" width="0" height="0"/>
        <properties>
            <property name="returnClass"/>
            <property name="stream"/>
            <property name="input-ref"/>
            <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/ee/data-mapper/transform"/>
            <property name="pipeSize"/>
            <property name="config-ref" value="a01xml2pv1_2_4_grf"/>
            <property name="auxiliary;index" value="84"/>
            <property-collection name="@http://www.mulesoft.org/schema/mule/ee/data-mapper/input-arguments;0">
                <property name="auxiliary;index" value="85"/>
                <property name="auxiliary;wrapIn" value="85"/>
                <property-collection name="@http://www.mulesoft.org/schema/mule/ee/data-mapper/input-argument;1">
                    <property name="value" value="#[pId]"/>
                    <property name="key" value="PatientIdentifier"/>
                    <property name="auxiliary;index" value="86"/>
                    <property name="auxiliary;wrapIn" value="86"/>
                </property-collection>
                <property-collection name="@http://www.mulesoft.org/schema/mule/ee/data-mapper/input-argument;2">
                    <property name="value" value="#[eventType]"/>
                    <property name="key" value="eventType"/>
                    <property name="auxiliary;index" value="87"/>
                    <property name="auxiliary;wrapIn" value="87"/>
                </property-collection>
            </property-collection>
        </properties>
    </pattern>
    <pattern name="Saving the mapped Patient" type="http://www.mulesoft.org/schema/mule/core/variable-transformer" entity-id="Variable#5">
        <graphicalData x="0" y="0" width="0" height="0"/>
        <properties>
            <property name="variableName" value="mappedPatientVisit"/>
            <property name="value" value="#[payload]"/>
            <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/core/set-variable"/>
            <property name="auxiliary;index" value="88"/>
        </properties>
    </pattern>
    <splitter index="89" name="Choice" type="org.mule.tooling.ui.modules.core.pattern.cbr" entity-id="Choice#3">
        <graphicalData x="0" y="0" width="0" height="0"/>
        <properties>
            <property-collection name="dc2d058a-e49b-4c70-9263-6c3f526a848a">
                <property name="choice.otherwise" value="true"/>
                <property-collection name="choice.attributes"/>
            </property-collection>
            <property-collection name="9b9c3eb2-1ad6-4ecd-a2f0-6752a872e4e3">
                <property name="choice.expression" value="#[groovy:payload.size() &gt;0 &amp;&amp; payload[0].Patient_Visit_Number__c]"/>
                <property-collection name="choice.attributes">
                    <property name="expression" value="#[groovy:payload.size() &gt;0 &amp;&amp; payload[0].Patient_Visit_Number__c]"/>
                </property-collection>
            </property-collection>
        </properties>
        <pattern name="Choice" type="org.mule.tooling.ui.modules.core.pattern.cbr" entity-id="Choice#4"/>
        <compartment entity-id="compartment#11">
            <lane hadOnlyOneElement="false" index="91" isChoiceOtherwiseLane="false" entity-id="9b9c3eb2-1ad6-4ecd-a2f0-6752a872e4e3">
                <pattern name="Lookup Patient Visit" type="http://www.mulesoft.org/schema/mule/sfdc/sfdc-connector" entity-id="Salesforce#5">
                    <graphicalData x="0" y="0" width="0" height="0"/>
                    <properties>
                        <property name=""/>
                        <property name="proxyUsername"/>
                        <property name="securityToken"/>
                        <property name="proxyHost"/>
                        <property name="query" value="SELECT Id,ADT_Patient__c, Facility__c, Room__c,Bed__c, Admission_Date__c,Discharge_Date__c, Patient_Visit_Number__c FROM ADT_Patient_Visit__c  WHERE Patient_Visit_Number__c='#[payload[0].Patient_Visit_Number__c]'"/>
                        <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/sfdc/query"/>
                        <property name="proxyPort"/>
                        <property name="password"/>
                        <property name="url"/>
                        <property name="username"/>
                        <property name="accessTokenId"/>
                        <property name="config-ref" value="UCSF_SF_Connection"/>
                        <property name="auxiliary;index" value="91"/>
                        <property name="proxyPassword"/>
                    </properties>
                </pattern>
                <pattern name="Saved Patient Visit Variable" type="http://www.mulesoft.org/schema/mule/core/variable-transformer" entity-id="Variable#6">
                    <graphicalData x="0" y="0" width="0" height="0"/>
                    <properties>
                        <property name="variableName" value="savedPatientVisit"/>
                        <property name="value" value="payload.size() &gt; 0 ? payload[0] : null"/>
                        <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/core/set-variable"/>
                        <property name="auxiliary;index" value="92"/>
                    </properties>
                </pattern>
                <pattern name="Set Payload" type="http://www.mulesoft.org/schema/mule/core/set-payload" entity-id="Set Payload#2">
                    <graphicalData x="0" y="0" width="0" height="0"/>
                    <properties>
                        <property name="value" value="#[flowVars['mappedPatientVisit']]"/>
                        <property name="auxiliary;index" value="93"/>
                    </properties>
                </pattern>
                <pattern name="Flow Reference" type="http://www.mulesoft.org/schema/mule/core/flow-ref" entity-id="Flow Reference#5">
                    <graphicalData x="0" y="0" width="0" height="0"/>
                    <properties>
                        <property name="name" value="addSalesforceNullField"/>
                        <property name="auxiliary;index" value="94"/>
                    </properties>
                </pattern>
                <pattern name="Upsert Patient visit" type="http://www.mulesoft.org/schema/mule/sfdc/sfdc-connector" entity-id="Salesforce#6">
                    <graphicalData x="0" y="0" width="0" height="0"/>
                    <properties>
                        <property name=""/>
                        <property name="proxyUsername"/>
                        <property name="securityToken"/>
                        <property name="proxyHost"/>
                        <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/sfdc/upsert"/>
                        <property name="proxyPort"/>
                        <property name="type" value="ADT_Patient_Visit__c"/>
                        <property name="password"/>
                        <property name="url"/>
                        <property name="externalIdFieldName" value="ExternalKey__c"/>
                        <property name="username"/>
                        <property name="accessTokenId"/>
                        <property name="config-ref" value="UCSF_SF_Connection"/>
                        <property name="proxyPassword"/>
                        <property name="auxiliary;index" value="95"/>
                        <property-collection name="@http://www.mulesoft.org/schema/mule/sfdc/upsert-objectss;0">
                            <property name="ref" value="#[payload:]"/>
                            <property name="auxiliary;index" value="96"/>
                            <property name="auxiliary;wrapIn" value="96"/>
                        </property-collection>
                    </properties>
                </pattern>
                <pattern name="Logger" type="http://www.mulesoft.org/schema/mule/core/logger" entity-id="Logger#8">
                    <graphicalData x="0" y="0" width="0" height="0"/>
                    <properties>
                        <property name="message" value="Subflow Patient Visit + #[payload]"/>
                        <property name="category"/>
                        <property name="level" value="INFO"/>
                        <property name="auxiliary;index" value="97"/>
                    </properties>
                </pattern>
                <pattern name="Set Patient visit Id" type="http://www.mulesoft.org/schema/mule/core/variable-transformer" entity-id="Variable#7">
                    <graphicalData x="0" y="0" width="0" height="0"/>
                    <properties>
                        <property name="variableName" value="pVisitId"/>
                        <property name="value" value="#[payload[0].Id]"/>
                        <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/core/set-variable"/>
                        <property name="auxiliary;index" value="98"/>
                    </properties>
                </pattern>
                <pattern name="Set Payload to originalXML" type="http://www.mulesoft.org/schema/mule/core/set-payload" entity-id="Set Payload#3">
                    <graphicalData x="0" y="0" width="0" height="0"/>
                    <properties>
                        <property name="value" value="#[orginalXML]"/>
                        <property name="auxiliary;index" value="99"/>
                    </properties>
                </pattern>
                <pattern name="DataMapper" type="http://www.mulesoft.org/schema/mule/ee/data-mapper/data-mapper-connector" entity-id="DataMapper#11">
                    <graphicalData x="0" y="0" width="0" height="0"/>
                    <properties>
                        <property name="returnClass"/>
                        <property name="stream"/>
                        <property name="input-ref"/>
                        <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/ee/data-mapper/transform"/>
                        <property name="pipeSize"/>
                        <property name="config-ref" value="attendingphysician_grf"/>
                        <property name="auxiliary;index" value="100"/>
                    </properties>
                </pattern>
                <pattern name="savedAttending" type="http://www.mulesoft.org/schema/mule/core/variable-transformer" entity-id="Variable#8">
                    <graphicalData x="0" y="0" width="0" height="0"/>
                    <properties>
                        <property name="variableName" value="savedAttending"/>
                        <property name="value" value="#[payload:]"/>
                        <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/core/set-variable"/>
                        <property name="auxiliary;index" value="101"/>
                    </properties>
                </pattern>
            </lane>
            <lane hadOnlyOneElement="false" index="103" isChoiceOtherwiseLane="true" entity-id="dc2d058a-e49b-4c70-9263-6c3f526a848a">
                <pattern name="Logger" type="http://www.mulesoft.org/schema/mule/core/logger" entity-id="Logger#9">
                    <graphicalData x="0" y="0" width="0" height="0"/>
                    <properties>
                        <property name="message" value="No Visit Id"/>
                        <property name="category"/>
                        <property name="level" value="INFO"/>
                        <property name="auxiliary;index" value="103"/>
                    </properties>
                </pattern>
            </lane>
        </compartment>
    </splitter>
</lane>
                            </compartment>
                        </scope>
                    </lane>
                </compartment>
            </scope>
            <pattern name="Message" type="http://www.mulesoft.org/schema/mule/core/message-filter" entity-id="Message#1">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="onUnaccepted"/>
                    <property name="throwOnUnaccepted"/>
                    <property name="auxiliary;index" value="107"/>
                    <property-collection name="@http://www.mulesoft.org/schema/mule/core/expression-filter;0">
                        <property name="expression" value="flowVars['pVisitId'] != null"/>
                        <property name="evaluator" value="groovy"/>
                        <property name="auxiliary;index" value="108"/>
                        <property name="auxiliary;wrapIn" value="108"/>
                    </property-collection>
                </properties>
            </pattern>
            <pattern name="Variable" type="http://www.mulesoft.org/schema/mule/core/variable-transformer" entity-id="Variable#9">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="variableName" value="roletype"/>
                    <property name="value" value="inpatient"/>
                    <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/core/set-variable"/>
                    <property name="auxiliary;index" value="109"/>
                </properties>
            </pattern>
            <scope name="Message Enricher" type="org.mule.tooling.ui.modules.core.scope.enricher" entity-id="Message Enricher#6">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="source"/>
                    <property name="target"/>
                    <property name="auxiliary;index" value="110"/>
                    <property-collection name="@http://www.mulesoft.org/schema/mule/core/enrich;0">
                        <property name="source" value="#[flowVars.?saveRoles]"/>
                        <property name="target" value="#[flowVars['saveInpatientRoles']]"/>
                        <property name="auxiliary;index" value="112"/>
                        <property name="auxiliary;wrapIn" value="112"/>
                    </property-collection>
                </properties>
                <compartment entity-id="compartment#12">
                    <lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#16">
                        <pattern name="Insert Patient Visit Role Flow" type="http://www.mulesoft.org/schema/mule/core/flow-ref" entity-id="Flow Reference#6">
                            <graphicalData x="0" y="0" width="0" height="0"/>
                            <properties>
<property name="name" value="mule-ucsf-insert-role"/>
<property name="auxiliary;index" value="111"/>
                            </properties>
                        </pattern>
                    </lane>
                </compartment>
            </scope>
        </lane>
    </flow>
    <flow SubFlow="true" name="defaultErrorHandler" entity-id="2ffef9d0-9e00-48ff-9449-775405fee20b">
        <properties>
            <property name="processingStrategy"/>
            <property name="processingStrategy2"/>
            <property name="bussinessEventsLabel"/>
            <property name="tracking:enable-default-events"/>
            <property name="auxiliary;index" value="113"/>
        </properties>
        <lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#17">
            <graphicalData x="0" y="0" width="0" height="0"/>
            <pattern name="Log Error" type="http://www.mulesoft.org/schema/mule/core/logger" entity-id="Logger#10">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="message" value="Error occurred: #[payload]"/>
                    <property name="category"/>
                    <property name="level" value="ERROR"/>
                    <property name="auxiliary;index" value="114"/>
                </properties>
            </pattern>
        </lane>
    </flow>
    <flow SubFlow="true" name="mule-ucsf-insert-role" entity-id="e54a516e-2bb5-4aea-9e62-6e236ea4ace7">
        <properties>
            <property name="processingStrategy"/>
            <property name="processingStrategy2"/>
            <property name="bussinessEventsLabel"/>
            <property name="tracking:enable-default-events"/>
            <property name="auxiliary;index" value="115"/>
        </properties>
        <lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#18">
            <graphicalData x="0" y="0" width="0" height="0"/>
            <pattern name="Flow Reference" type="http://www.mulesoft.org/schema/mule/core/flow-ref" entity-id="Flow Reference#7">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="name" value="getMappedRoles"/>
                    <property name="auxiliary;index" value="116"/>
                </properties>
            </pattern>
            <scope name="Enrich Get ucsfIds Ids" type="org.mule.tooling.ui.modules.core.scope.enricher" entity-id="Message Enricher#7">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="source" value="#[payload]"/>
                    <property name="target" value="#[variable:ucsfIds]"/>
                    <property name="auxiliary;index" value="117"/>
                </properties>
                <compartment entity-id="compartment#13">
                    <lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#19">
                        <pattern name="Flow Reference" type="http://www.mulesoft.org/schema/mule/core/flow-ref" entity-id="Flow Reference#8">
                            <graphicalData x="0" y="0" width="0" height="0"/>
                            <properties>
<property name="name" value="getUcsfIds"/>
<property name="auxiliary;index" value="118"/>
                            </properties>
                        </pattern>
                    </lane>
                </compartment>
            </scope>
            <pattern name="Message" type="http://www.mulesoft.org/schema/mule/core/message-filter" entity-id="Message#2">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="onUnaccepted"/>
                    <property name="throwOnUnaccepted"/>
                    <property name="auxiliary;index" value="119"/>
                    <property-collection name="@http://www.mulesoft.org/schema/mule/core/expression-filter;0">
                        <property name="expression" value="ucsfIds != ''"/>
                        <property name="evaluator" value="groovy"/>
                        <property name="auxiliary;index" value="120"/>
                        <property name="auxiliary;wrapIn" value="120"/>
                    </property-collection>
                </properties>
            </pattern>
            <pattern name="Lookup for  ucsfId" type="http://www.mulesoft.org/schema/mule/sfdc/sfdc-connector" entity-id="Salesforce#7">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name=""/>
                    <property name="proxyUsername"/>
                    <property name="securityToken"/>
                    <property name="proxyHost"/>
                    <property name="query" value="SELECT id,UCSF_ID__c FROM Contact where UCSF_ID__c in (#[ucsfIds]) "/>
                    <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/sfdc/query"/>
                    <property name="proxyPort"/>
                    <property name="password"/>
                    <property name="url"/>
                    <property name="username"/>
                    <property name="accessTokenId"/>
                    <property name="config-ref" value="UCSF_SF_Connection"/>
                    <property name="auxiliary;index" value="121"/>
                    <property name="proxyPassword"/>
                </properties>
            </pattern>
            <pattern name="Variable" type="http://www.mulesoft.org/schema/mule/core/variable-transformer" entity-id="Variable#10">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="variableName" value="ucsfid_salesforceid"/>
                    <property name="value" value="#[payload:]"/>
                    <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/core/set-variable"/>
                    <property name="auxiliary;index" value="122"/>
                </properties>
            </pattern>
            <pattern name="Flow Reference getUpsertRoleListWithOtherIds" type="http://www.mulesoft.org/schema/mule/core/flow-ref" entity-id="Flow Reference#9">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="name" value="getUpsertRoleListWithOtherIds"/>
                    <property name="auxiliary;index" value="123"/>
                </properties>
            </pattern>
            <pattern name="save mapped roles Roles" type="http://www.mulesoft.org/schema/mule/core/variable-transformer" entity-id="Variable#11">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="variableName" value="rolesForUpsertList"/>
                    <property name="value" value="#[payload]"/>
                    <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/core/set-variable"/>
                    <property name="auxiliary;index" value="124"/>
                </properties>
            </pattern>
            <pattern name="checkUpsertListSize" type="http://www.mulesoft.org/schema/mule/core/message-filter" entity-id="Message#3">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="onUnaccepted"/>
                    <property name="throwOnUnaccepted"/>
                    <property name="auxiliary;index" value="125"/>
                    <property-collection name="@http://www.mulesoft.org/schema/mule/core/expression-filter;0">
                        <property name="expression" value="payload.size()  &gt; 0"/>
                        <property name="evaluator" value="groovy"/>
                        <property name="auxiliary;index" value="126"/>
                        <property name="auxiliary;wrapIn" value="126"/>
                    </property-collection>
                </properties>
                <description>Don't continue if there rolesForUpsertList blank</description>
            </pattern>
            <pattern name="DataMapper" type="http://www.mulesoft.org/schema/mule/ee/data-mapper/data-mapper-connector" entity-id="DataMapper#12">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="returnClass"/>
                    <property name="stream"/>
                    <property name="input-ref"/>
                    <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/ee/data-mapper/transform"/>
                    <property name="pipeSize"/>
                    <property name="config-ref" value="mapproletosalesforceobject_grf"/>
                    <property name="auxiliary;index" value="127"/>
                    <property-collection name="@http://www.mulesoft.org/schema/mule/ee/data-mapper/input-arguments;0">
                        <property name="auxiliary;index" value="128"/>
                        <property name="auxiliary;wrapIn" value="128"/>
                        <property-collection name="@http://www.mulesoft.org/schema/mule/ee/data-mapper/input-argument;1">
                            <property name="value" value="#[pId]"/>
                            <property name="key" value="patientId"/>
                            <property name="auxiliary;index" value="129"/>
                            <property name="auxiliary;wrapIn" value="129"/>
                        </property-collection>
                        <property-collection name="@http://www.mulesoft.org/schema/mule/ee/data-mapper/input-argument;3">
                            <property name="value" value="#[flowVars.?roletype]"/>
                            <property name="key" value="roletype"/>
                            <property name="auxiliary;index" value="131"/>
                            <property name="auxiliary;wrapIn" value="131"/>
                        </property-collection>
                        <property-collection name="@http://www.mulesoft.org/schema/mule/ee/data-mapper/input-argument;2">
                            <property name="value" value="#[flowVars.?pVisitId]"/>
                            <property name="key" value="patientVisitId"/>
                            <property name="auxiliary;index" value="130"/>
                            <property name="auxiliary;wrapIn" value="130"/>
                        </property-collection>
                    </property-collection>
                </properties>
            </pattern>
            <pattern name="save mapped roles Roles" type="http://www.mulesoft.org/schema/mule/core/variable-transformer" entity-id="Variable#12">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="variableName" value="mappedrolesForUpsertList"/>
                    <property name="value" value="#[payload]"/>
                    <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/core/set-variable"/>
                    <property name="auxiliary;index" value="132"/>
                </properties>
            </pattern>
            <splitter index="133" name="Choice" type="org.mule.tooling.ui.modules.core.pattern.cbr" entity-id="Choice#5">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property-collection name="0b7a23ac-b830-440a-b204-928b2504b701">
                        <property name="choice.otherwise" value="true"/>
                        <property-collection name="choice.attributes"/>
                    </property-collection>
                    <property-collection name="85075b5c-0065-4bde-8ceb-7351793b446d">
                        <property name="choice.expression" value="#[groovy:roletype == 'inpatient']"/>
                        <property-collection name="choice.attributes">
                            <property name="expression" value="#[groovy:roletype == 'inpatient']"/>
                        </property-collection>
                    </property-collection>
                </properties>
                <pattern name="Choice" type="org.mule.tooling.ui.modules.core.pattern.cbr" entity-id="Choice#6"/>
                <compartment entity-id="compartment#14">
                    <lane hadOnlyOneElement="false" index="135" isChoiceOtherwiseLane="false" entity-id="85075b5c-0065-4bde-8ceb-7351793b446d">
                        <pattern name="Salesforce" type="http://www.mulesoft.org/schema/mule/sfdc/sfdc-connector" entity-id="Salesforce#8">
                            <graphicalData x="0" y="0" width="0" height="0"/>
                            <properties>
<property name=""/>
<property name="proxyUsername"/>
<property name="securityToken"/>
<property name="proxyHost"/>
<property name="query" value="SELECT ADT_Patient__c, Id, ADT_Patient_Visit__c, Active__c, Provider__c, ExternalKey__c  FROM ADT_Patient_Visit_Care_Role__c where ADT_Patient__c ='#[pId]' and ADT_Patient_Visit__c='#[pVisitId]'  and Active__c=true"/>
<property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/sfdc/query"/>
<property name="proxyPort"/>
<property name="password"/>
<property name="url"/>
<property name="username"/>
<property name="accessTokenId"/>
<property name="config-ref" value="UCSF_SF_Connection"/>
<property name="auxiliary;index" value="135"/>
<property name="proxyPassword"/>
                            </properties>
                        </pattern>
                    </lane>
                    <lane hadOnlyOneElement="false" index="137" isChoiceOtherwiseLane="true" entity-id="0b7a23ac-b830-440a-b204-928b2504b701">
                        <pattern name="Salesforce" type="http://www.mulesoft.org/schema/mule/sfdc/sfdc-connector" entity-id="Salesforce#9">
                            <graphicalData x="0" y="0" width="0" height="0"/>
                            <properties>
<property name=""/>
<property name="proxyUsername"/>
<property name="securityToken"/>
<property name="proxyHost"/>
<property name="query" value="SELECT ADT_Patient__c, Id, Active__c, Provider__c, ExternalKey__c FROM ADT_Patient_Care_Role__c where ADT_Patient__c ='#[pId]'   and Active__c=true"/>
<property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/sfdc/query"/>
<property name="proxyPort"/>
<property name="password"/>
<property name="url"/>
<property name="username"/>
<property name="accessTokenId"/>
<property name="config-ref" value="UCSF_SF_Connection"/>
<property name="auxiliary;index" value="137"/>
<property name="proxyPassword"/>
                            </properties>
                        </pattern>
                    </lane>
                </compartment>
            </splitter>
            <pattern name="save current Roles" type="http://www.mulesoft.org/schema/mule/core/variable-transformer" entity-id="Variable#13">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="variableName" value="saveRoles"/>
                    <property name="value" value="#[payload]"/>
                    <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/core/set-variable"/>
                    <property name="auxiliary;index" value="138"/>
                </properties>
            </pattern>
            <splitter index="139" name="Choice" type="org.mule.tooling.ui.modules.core.pattern.cbr" entity-id="Choice#7">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property-collection name="da9b9236-469f-4a57-85e4-665c09dc3509">
                        <property name="choice.otherwise" value="true"/>
                        <property-collection name="choice.attributes"/>
                    </property-collection>
                    <property-collection name="6010309c-cc3f-4ef1-97c4-afa80b0d419a">
                        <property name="choice.expression" value="#[groovy:roletype == 'inpatient' &amp;&amp; flowVars['eventType'] == 'A03']"/>
                        <property-collection name="choice.attributes">
                            <property name="expression" value="#[groovy:roletype == 'inpatient' &amp;&amp; flowVars['eventType'] == 'A03']"/>
                        </property-collection>
                    </property-collection>
                </properties>
                <pattern name="Choice" type="org.mule.tooling.ui.modules.core.pattern.cbr" entity-id="Choice#8"/>
                <compartment entity-id="compartment#15">
                    <lane hadOnlyOneElement="false" index="141" isChoiceOtherwiseLane="false" entity-id="6010309c-cc3f-4ef1-97c4-afa80b0d419a">
                        <pattern name="Flow Reference" type="http://www.mulesoft.org/schema/mule/core/flow-ref" entity-id="Flow Reference#10">
                            <graphicalData x="0" y="0" width="0" height="0"/>
                            <properties>
<property name="name" value="getRolesToUpsertForDeactivation"/>
<property name="auxiliary;index" value="141"/>
                            </properties>
                        </pattern>
                    </lane>
                    <lane hadOnlyOneElement="false" index="143" isChoiceOtherwiseLane="true" entity-id="da9b9236-469f-4a57-85e4-665c09dc3509">
                        <pattern name="Flow Reference" type="http://www.mulesoft.org/schema/mule/core/flow-ref" entity-id="Flow Reference#11">
                            <graphicalData x="0" y="0" width="0" height="0"/>
                            <properties>
<property name="name" value="getFinalRolesToUpsert"/>
<property name="auxiliary;index" value="143"/>
                            </properties>
                        </pattern>
                        <pattern name="handle salesforce null" type="http://www.mulesoft.org/schema/mule/core/flow-ref" entity-id="Flow Reference#12">
                            <graphicalData x="0" y="0" width="0" height="0"/>
                            <properties>
<property name="name" value="addSalesforceNullField"/>
<property name="auxiliary;index" value="144"/>
                            </properties>
                        </pattern>
                    </lane>
                </compartment>
            </splitter>
            <splitter index="145" name="Choice" type="org.mule.tooling.ui.modules.core.pattern.cbr" entity-id="Choice#9">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property-collection name="cfde2802-ecc3-406b-9bd6-ba35455734db">
                        <property name="choice.expression" value="roletype == 'inpatient'"/>
                        <property-collection name="choice.attributes">
                            <property name="expression" value="roletype == 'inpatient'"/>
                        </property-collection>
                    </property-collection>
                    <property-collection name="19311b03-6eae-40a0-8a23-75f6b82be9b4">
                        <property name="choice.otherwise" value="true"/>
                        <property-collection name="choice.attributes"/>
                    </property-collection>
                </properties>
                <pattern name="Choice" type="org.mule.tooling.ui.modules.core.pattern.cbr" entity-id="Choice#10"/>
                <compartment entity-id="compartment#16">
                    <lane hadOnlyOneElement="false" index="147" isChoiceOtherwiseLane="false" entity-id="cfde2802-ecc3-406b-9bd6-ba35455734db">
                        <pattern name="Salesforce" type="http://www.mulesoft.org/schema/mule/sfdc/sfdc-connector" entity-id="Salesforce#10">
                            <graphicalData x="0" y="0" width="0" height="0"/>
                            <properties>
<property name=""/>
<property name="proxyUsername"/>
<property name="securityToken"/>
<property name="proxyHost"/>
<property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/sfdc/upsert"/>
<property name="proxyPort"/>
<property name="type" value="ADT_Patient_Visit_Care_Role__c"/>
<property name="password"/>
<property name="url"/>
<property name="externalIdFieldName" value="ExternalKey__c"/>
<property name="username"/>
<property name="accessTokenId"/>
<property name="config-ref" value="UCSF_SF_Connection"/>
<property name="proxyPassword"/>
<property name="auxiliary;index" value="147"/>
<property-collection name="@http://www.mulesoft.org/schema/mule/sfdc/upsert-objectss;0">
    <property name="ref" value="#[payload]"/>
    <property name="auxiliary;index" value="148"/>
    <property name="auxiliary;wrapIn" value="148"/>
</property-collection>
                            </properties>
                        </pattern>
                    </lane>
                    <lane hadOnlyOneElement="false" index="150" isChoiceOtherwiseLane="true" entity-id="19311b03-6eae-40a0-8a23-75f6b82be9b4">
                        <pattern name="Salesforce" type="http://www.mulesoft.org/schema/mule/sfdc/sfdc-connector" entity-id="Salesforce#11">
                            <graphicalData x="0" y="0" width="0" height="0"/>
                            <properties>
<property name=""/>
<property name="proxyUsername"/>
<property name="securityToken"/>
<property name="proxyHost"/>
<property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/sfdc/upsert"/>
<property name="proxyPort"/>
<property name="type" value="ADT_Patient_Care_Role__c"/>
<property name="password"/>
<property name="url"/>
<property name="externalIdFieldName" value="ExternalKey__c"/>
<property name="username"/>
<property name="accessTokenId"/>
<property name="config-ref" value="UCSF_SF_Connection"/>
<property name="proxyPassword"/>
<property name="auxiliary;index" value="150"/>
<property-collection name="@http://www.mulesoft.org/schema/mule/sfdc/upsert-objectss;0">
    <property name="ref" value="#[payload]"/>
    <property name="auxiliary;index" value="151"/>
    <property name="auxiliary;wrapIn" value="151"/>
</property-collection>
                            </properties>
                        </pattern>
                    </lane>
                </compartment>
            </splitter>
            <pattern name="Logger" type="http://www.mulesoft.org/schema/mule/core/logger" entity-id="Logger#11">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="message"/>
                    <property name="category"/>
                    <property name="level" value="DEBUG"/>
                    <property name="auxiliary;index" value="152"/>
                </properties>
            </pattern>
        </lane>
    </flow>
    <flow SubFlow="true" name="getMappedRoles" entity-id="a7a8663c-0e38-45a5-a748-233cad43b02b">
        <properties>
            <property name="processingStrategy"/>
            <property name="processingStrategy2"/>
            <property name="bussinessEventsLabel"/>
            <property name="tracking:enable-default-events"/>
            <property name="auxiliary;index" value="153"/>
        </properties>
        <lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#20">
            <graphicalData x="0" y="0" width="0" height="0"/>
            <pattern name="save originalXML" type="http://www.mulesoft.org/schema/mule/core/variable-transformer" entity-id="Variable#14">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="variableName" value="orginalXML"/>
                    <property name="value" value="#[payload:]"/>
                    <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/core/set-variable"/>
                    <property name="auxiliary;index" value="154"/>
                </properties>
            </pattern>
            <pattern name="XSLT" type="http://www.mulesoft.org/schema/mule/xml/xslt-transformer" entity-id="XSLT#1">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="returnClass" value="java.lang.String"/>
                    <property name="xsl-file"/>
                    <property name="ignoreBadInput"/>
                    <property name="maxActiveTransformers" value="5"/>
                    <property name="encoding"/>
                    <property name="transformerFactoryClass"/>
                    <property name="outputEncoding"/>
                    <property name="mimeType"/>
                    <property name="auxiliary;index" value="155"/>
                    <property name="maxIdleTransformers" value="2"/>
                    <property name="uriResolver-ref"/>
                    <property-collection name="@http://www.mulesoft.org/schema/mule/xml/xslt-text;0">
                        <property name="xslt-text" value="&#xA;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;"/>
                        <property name="auxiliary;index" value="156"/>
                        <property name="auxiliary;wrapIn" value="156"/>
                    </property-collection>
                </properties>
            </pattern>
            <pattern name="DataMapper" type="http://www.mulesoft.org/schema/mule/ee/data-mapper/data-mapper-connector" entity-id="DataMapper#13">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="returnClass"/>
                    <property name="stream"/>
                    <property name="input-ref"/>
                    <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/ee/data-mapper/transform"/>
                    <property name="pipeSize"/>
                    <property name="config-ref" value="maproletoobject_grf"/>
                    <property name="auxiliary;index" value="187"/>
                </properties>
            </pattern>
            <splitter index="188" name="Choice" type="org.mule.tooling.ui.modules.core.pattern.cbr" entity-id="Choice#11">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property-collection name="aa88f9ef-d332-4667-8a76-30794e45e9c2">
                        <property name="choice.otherwise" value="true"/>
                        <property-collection name="choice.attributes"/>
                    </property-collection>
                    <property-collection name="59b37b14-b29f-49b8-a745-2546f6ab5675">
                        <property name="choice.expression" value="#[groovy:roletype == 'inpatient']"/>
                        <property-collection name="choice.attributes">
                            <property name="expression" value="#[groovy:roletype == 'inpatient']"/>
                        </property-collection>
                    </property-collection>
                </properties>
                <pattern name="Choice" type="org.mule.tooling.ui.modules.core.pattern.cbr" entity-id="Choice#12"/>
                <compartment entity-id="compartment#17">
                    <lane hadOnlyOneElement="false" index="190" isChoiceOtherwiseLane="false" entity-id="59b37b14-b29f-49b8-a745-2546f6ab5675">
                        <pattern name="Flow Reference" type="http://www.mulesoft.org/schema/mule/core/flow-ref" entity-id="Flow Reference#13">
                            <graphicalData x="0" y="0" width="0" height="0"/>
                            <properties>
<property name="name" value="addAttending"/>
<property name="auxiliary;index" value="190"/>
                            </properties>
                        </pattern>
                        <pattern name="patientRolsVariable" type="http://www.mulesoft.org/schema/mule/core/variable-transformer" entity-id="Variable#15">
                            <graphicalData x="0" y="0" width="0" height="0"/>
                            <properties>
<property name="variableName" value="patientADTROLs"/>
<property name="value" value="#[payload:]"/>
<property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/core/set-variable"/>
<property name="auxiliary;index" value="191"/>
                            </properties>
                        </pattern>
                    </lane>
                    <lane hadOnlyOneElement="false" index="193" isChoiceOtherwiseLane="true" entity-id="aa88f9ef-d332-4667-8a76-30794e45e9c2">
                        <pattern name="patientRolsVariable" type="http://www.mulesoft.org/schema/mule/core/variable-transformer" entity-id="Variable#16">
                            <graphicalData x="0" y="0" width="0" height="0"/>
                            <properties>
<property name="variableName" value="patientADTROLs"/>
<property name="value" value="#[payload:]"/>
<property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/core/set-variable"/>
<property name="auxiliary;index" value="193"/>
                            </properties>
                        </pattern>
                    </lane>
                </compartment>
            </splitter>
        </lane>
    </flow>
    <flow SubFlow="true" name="SaveADT" entity-id="1a7a1dc9-5c57-4044-a0e5-1b4bcb0b3f9a">
        <properties>
            <property name="processingStrategy"/>
            <property name="processingStrategy2"/>
            <property name="bussinessEventsLabel"/>
            <property name="tracking:enable-default-events"/>
            <property name="auxiliary;index" value="194"/>
        </properties>
        <lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#21">
            <graphicalData x="0" y="0" width="0" height="0"/>
            <pattern name="Salesforce" type="http://www.mulesoft.org/schema/mule/sfdc/sfdc-connector" entity-id="Salesforce#12">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name=""/>
                    <property name="proxyUsername"/>
                    <property name="securityToken"/>
                    <property name="proxyHost"/>
                    <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/sfdc/create-single"/>
                    <property name="proxyPort"/>
                    <property name="type" value="ADT_Message__c"/>
                    <property name="password"/>
                    <property name="url"/>
                    <property name="username"/>
                    <property name="accessTokenId"/>
                    <property name="config-ref" value="UCSF_SF_Connection"/>
                    <property name="auxiliary;index" value="195"/>
                    <property name="proxyPassword"/>
                    <property-collection name="@http://www.mulesoft.org/schema/mule/sfdc/create-single-objects;0">
                        <property name="auxiliary;index" value="196"/>
                        <property name="auxiliary;wrapIn" value="196"/>
                        <property-collection name="@http://www.mulesoft.org/schema/mule/sfdc/create-single-object;1">
                            <property name="value" value="#[payload]"/>
                            <property name="key" value="ADT_String__c"/>
                            <property name="auxiliary;index" value="197"/>
                            <property name="auxiliary;wrapIn" value="197"/>
                        </property-collection>
                    </property-collection>
                </properties>
            </pattern>
        </lane>
    </flow>
    <flow SubFlow="true" name="updateSalesforce" entity-id="301a6824-2d80-4997-8f53-0fb39217a83d">
        <properties>
            <property name="processingStrategy"/>
            <property name="processingStrategy2"/>
            <property name="bussinessEventsLabel"/>
            <property name="tracking:enable-default-events"/>
            <property name="auxiliary;index" value="198"/>
        </properties>
        <lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#22">
            <graphicalData x="0" y="0" width="0" height="0"/>
            <pattern name="Salesforce" type="http://www.mulesoft.org/schema/mule/sfdc/sfdc-connector" entity-id="Salesforce#13">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name=""/>
                    <property name="proxyUsername"/>
                    <property name="securityToken"/>
                    <property name="proxyHost"/>
                    <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/sfdc/upsert"/>
                    <property name="proxyPort"/>
                    <property name="type" value="ADT_Patient__c"/>
                    <property name="password"/>
                    <property name="url"/>
                    <property name="externalIdFieldName" value="MRN_Number__c"/>
                    <property name="username"/>
                    <property name="accessTokenId"/>
                    <property name="config-ref" value="UCSF_SF_Connection"/>
                    <property name="proxyPassword"/>
                    <property name="auxiliary;index" value="199"/>
                    <property-collection name="@http://www.mulesoft.org/schema/mule/sfdc/upsert-objectss;0">
                        <property name="auxiliary;index" value="200"/>
                        <property name="auxiliary;wrapIn" value="200"/>
                        <property-collection name="@http://www.mulesoft.org/schema/mule/sfdc/upsert-objects;1">
                            <property name="auxiliary;index" value="201"/>
                            <property name="auxiliary;wrapIn" value="201"/>
                            <property-collection name="@http://www.mulesoft.org/schema/mule/sfdc/inner-upsert-objects;2">
<property name="value" value="#[mappedPatient[0].MRN_Number__c]"/>
<property name="key" value="MRN_Number__c"/>
<property name="auxiliary;index" value="203"/>
<property name="auxiliary;wrapIn" value="203"/>
                            </property-collection>
                            <property-collection name="@http://www.mulesoft.org/schema/mule/sfdc/inner-upsert-objects;1">
<property name="value" value="#[groovy:new GregorianCalendar()]"/>
<property name="key" value="MuleUpdateDatetime__c"/>
<property name="auxiliary;index" value="202"/>
<property name="auxiliary;wrapIn" value="202"/>
                            </property-collection>
                        </property-collection>
                    </property-collection>
                </properties>
            </pattern>
            <pattern name="Salesforce" type="http://www.mulesoft.org/schema/mule/sfdc/sfdc-connector" entity-id="Salesforce#14">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name=""/>
                    <property name="proxyUsername"/>
                    <property name="securityToken"/>
                    <property name="proxyHost"/>
                    <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/sfdc/upsert"/>
                    <property name="proxyPort"/>
                    <property name="type" value="ADT_Message__c"/>
                    <property name="password"/>
                    <property name="url"/>
                    <property name="externalIdFieldName" value="Id"/>
                    <property name="username"/>
                    <property name="accessTokenId"/>
                    <property name="config-ref" value="UCSF_SF_Connection"/>
                    <property name="proxyPassword"/>
                    <property name="auxiliary;index" value="204"/>
                    <property-collection name="@http://www.mulesoft.org/schema/mule/sfdc/upsert-objectss;0">
                        <property name="auxiliary;index" value="205"/>
                        <property name="auxiliary;wrapIn" value="205"/>
                        <property-collection name="@http://www.mulesoft.org/schema/mule/sfdc/upsert-objects;1">
                            <property name="auxiliary;index" value="206"/>
                            <property name="auxiliary;wrapIn" value="206"/>
                            <property-collection name="@http://www.mulesoft.org/schema/mule/sfdc/inner-upsert-objects;6">
<property name="value" value="#[groovy:warnings.toString().length() &gt; 0 ? &quot;WARN&quot; : &quot;INFO&quot;]"/>
<property name="key" value="LogLevel__c"/>
<property name="auxiliary;index" value="212"/>
<property name="auxiliary;wrapIn" value="212"/>
                            </property-collection>
                            <property-collection name="@http://www.mulesoft.org/schema/mule/sfdc/inner-upsert-objects;3">
<property name="value" value="#[groovy:warnings.toString()]"/>
<property name="key" value="log__c"/>
<property name="auxiliary;index" value="209"/>
<property name="auxiliary;wrapIn" value="209"/>
                            </property-collection>
                            <property-collection name="@http://www.mulesoft.org/schema/mule/sfdc/inner-upsert-objects;2">
<property name="value" value="#[flowVars.?pId]"/>
<property name="key" value="ADT_Patient__c"/>
<property name="auxiliary;index" value="208"/>
<property name="auxiliary;wrapIn" value="208"/>
                            </property-collection>
                            <property-collection name="@http://www.mulesoft.org/schema/mule/sfdc/inner-upsert-objects;5">
<property name="value" value="#[flowVars.?controlID]"/>
<property name="key" value="ControlID__c"/>
<property name="auxiliary;index" value="211"/>
<property name="auxiliary;wrapIn" value="211"/>
                            </property-collection>
                            <property-collection name="@http://www.mulesoft.org/schema/mule/sfdc/inner-upsert-objects;4">
<property name="value" value="#[flowVars.?eventType]"/>
<property name="key" value="eventType__c"/>
<property name="auxiliary;index" value="210"/>
<property name="auxiliary;wrapIn" value="210"/>
                            </property-collection>
                            <property-collection name="@http://www.mulesoft.org/schema/mule/sfdc/inner-upsert-objects;1">
<property name="value" value="#[messageId]"/>
<property name="key" value="Id"/>
<property name="auxiliary;index" value="207"/>
<property name="auxiliary;wrapIn" value="207"/>
                            </property-collection>
                        </property-collection>
                    </property-collection>
                </properties>
            </pattern>
        </lane>
    </flow>
    <flow SubFlow="true" name="messageUnsupportedLogging" entity-id="e4a0fad2-1cae-410d-b4e0-6798bf1bae44">
        <properties>
            <property name="processingStrategy"/>
            <property name="processingStrategy2"/>
            <property name="bussinessEventsLabel"/>
            <property name="tracking:enable-default-events"/>
            <property name="auxiliary;index" value="213"/>
        </properties>
        <lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#23">
            <graphicalData x="0" y="0" width="0" height="0"/>
            <pattern name="Salesforce" type="http://www.mulesoft.org/schema/mule/sfdc/sfdc-connector" entity-id="Salesforce#15">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name=""/>
                    <property name="proxyUsername"/>
                    <property name="securityToken"/>
                    <property name="proxyHost"/>
                    <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/sfdc/upsert"/>
                    <property name="proxyPort"/>
                    <property name="type" value="ADT_Message__c"/>
                    <property name="password"/>
                    <property name="url"/>
                    <property name="externalIdFieldName" value="Id"/>
                    <property name="username"/>
                    <property name="accessTokenId"/>
                    <property name="config-ref" value="UCSF_SF_Connection"/>
                    <property name="proxyPassword"/>
                    <property name="auxiliary;index" value="214"/>
                    <property-collection name="@http://www.mulesoft.org/schema/mule/sfdc/upsert-objectss;0">
                        <property name="auxiliary;index" value="215"/>
                        <property name="auxiliary;wrapIn" value="215"/>
                        <property-collection name="@http://www.mulesoft.org/schema/mule/sfdc/upsert-objects;1">
                            <property name="auxiliary;index" value="216"/>
                            <property name="auxiliary;wrapIn" value="216"/>
                            <property-collection name="@http://www.mulesoft.org/schema/mule/sfdc/inner-upsert-objects;3">
<property name="value" value="#[flowVars.?eventType]"/>
<property name="key" value="eventType__c"/>
<property name="auxiliary;index" value="219"/>
<property name="auxiliary;wrapIn" value="219"/>
                            </property-collection>
                            <property-collection name="@http://www.mulesoft.org/schema/mule/sfdc/inner-upsert-objects;2">
<property name="value" value="#[payload] "/>
<property name="key" value="log__c"/>
<property name="auxiliary;index" value="218"/>
<property name="auxiliary;wrapIn" value="218"/>
                            </property-collection>
                            <property-collection name="@http://www.mulesoft.org/schema/mule/sfdc/inner-upsert-objects;4">
<property name="value" value="WARN"/>
<property name="key" value="LogLevel__c"/>
<property name="auxiliary;index" value="220"/>
<property name="auxiliary;wrapIn" value="220"/>
                            </property-collection>
                            <property-collection name="@http://www.mulesoft.org/schema/mule/sfdc/inner-upsert-objects;1">
<property name="value" value="#[messageId]"/>
<property name="key" value="Id"/>
<property name="auxiliary;index" value="217"/>
<property name="auxiliary;wrapIn" value="217"/>
                            </property-collection>
                        </property-collection>
                    </property-collection>
                </properties>
            </pattern>
        </lane>
    </flow>
    <flow SubFlow="true" name="messageErrorLogging" entity-id="c068a06a-9e58-4316-ac2f-fd10d54e64be">
        <properties>
            <property name="processingStrategy"/>
            <property name="processingStrategy2"/>
            <property name="bussinessEventsLabel"/>
            <property name="tracking:enable-default-events"/>
            <property name="auxiliary;index" value="221"/>
        </properties>
        <lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#24">
            <graphicalData x="0" y="0" width="0" height="0"/>
            <pattern name="Salesforce" type="http://www.mulesoft.org/schema/mule/sfdc/sfdc-connector" entity-id="Salesforce#16">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name=""/>
                    <property name="proxyUsername"/>
                    <property name="securityToken"/>
                    <property name="proxyHost"/>
                    <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/sfdc/upsert"/>
                    <property name="proxyPort"/>
                    <property name="type" value="ADT_Message__c"/>
                    <property name="password"/>
                    <property name="url"/>
                    <property name="externalIdFieldName" value="Id"/>
                    <property name="username"/>
                    <property name="accessTokenId"/>
                    <property name="config-ref" value="UCSF_SF_Connection"/>
                    <property name="proxyPassword"/>
                    <property name="auxiliary;index" value="222"/>
                    <property-collection name="@http://www.mulesoft.org/schema/mule/sfdc/upsert-objectss;0">
                        <property name="auxiliary;index" value="223"/>
                        <property name="auxiliary;wrapIn" value="223"/>
                        <property-collection name="@http://www.mulesoft.org/schema/mule/sfdc/upsert-objects;1">
                            <property name="auxiliary;index" value="224"/>
                            <property name="auxiliary;wrapIn" value="224"/>
                            <property-collection name="@http://www.mulesoft.org/schema/mule/sfdc/inner-upsert-objects;6">
<property name="value" value="ERROR"/>
<property name="key" value="LogLevel__c"/>
<property name="auxiliary;index" value="230"/>
<property name="auxiliary;wrapIn" value="230"/>
                            </property-collection>
                            <property-collection name="@http://www.mulesoft.org/schema/mule/sfdc/inner-upsert-objects;3">
<property name="value" value="Error Payload #[payload]\n exception #[exception] "/>
<property name="key" value="log__c"/>
<property name="auxiliary;index" value="227"/>
<property name="auxiliary;wrapIn" value="227"/>
                            </property-collection>
                            <property-collection name="@http://www.mulesoft.org/schema/mule/sfdc/inner-upsert-objects;2">
<property name="value" value="#[flowVars.?pId]"/>
<property name="key" value="ADT_Patient__c"/>
<property name="auxiliary;index" value="226"/>
<property name="auxiliary;wrapIn" value="226"/>
                            </property-collection>
                            <property-collection name="@http://www.mulesoft.org/schema/mule/sfdc/inner-upsert-objects;5">
<property name="value" value="#[flowVars.?controlID]"/>
<property name="key" value="ControlID__c"/>
<property name="auxiliary;index" value="229"/>
<property name="auxiliary;wrapIn" value="229"/>
                            </property-collection>
                            <property-collection name="@http://www.mulesoft.org/schema/mule/sfdc/inner-upsert-objects;4">
<property name="value" value="#[flowVars.?eventType]"/>
<property name="key" value="eventType__c"/>
<property name="auxiliary;index" value="228"/>
<property name="auxiliary;wrapIn" value="228"/>
                            </property-collection>
                            <property-collection name="@http://www.mulesoft.org/schema/mule/sfdc/inner-upsert-objects;1">
<property name="value" value="#[messageId]"/>
<property name="key" value="Id"/>
<property name="auxiliary;index" value="225"/>
<property name="auxiliary;wrapIn" value="225"/>
                            </property-collection>
                        </property-collection>
                    </property-collection>
                </properties>
            </pattern>
        </lane>
    </flow>
    <flow SubFlow="false" name="dummyhl7Flow1" entity-id="4e22f910-67c7-48f0-ade8-5a4016955aad">
        <properties>
            <property name="processingStrategy"/>
            <property name="processingStrategy2"/>
            <property name="bussinessEventsLabel"/>
            <property name="tracking:enable-default-events"/>
            <property name="auxiliary;index" value="231"/>
        </properties>
        <lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#25">
            <graphicalData x="0" y="0" width="0" height="0"/>
            <endpoint direction="Inbound" message-exchange-pattern="RequestResponse" name="HTTP" type="http://www.mulesoft.org/schema/mule/http/endpoint" entity-id="HTTP#1">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="port" value="9000"/>
                    <property name="host" value="0.0.0.0"/>
                    <property name="businessEventsLabel"/>
                    <property name="followRedirects"/>
                    <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/http/endpoint"/>
                    <property name="keep-alive"/>
                    <property name="contentType"/>
                    <property name="disableTransportTransformer"/>
                    <property name="password"/>
                    <property name="exchange-pattern" value="request-response"/>
                    <property name="tracking:enable-default-events"/>
                    <property name="ref"/>
                    <property name="transformer-refs"/>
                    <property name="httpLabel"/>
                    <property name="address"/>
                    <property name="path"/>
                    <property name="encoding"/>
                    <property name="responseTransformer-refs"/>
                    <property name="method"/>
                    <property name="user"/>
                    <property name="responseTimeout"/>
                    <property name="mimeType"/>
                    <property name="auxiliary;index" value="232"/>
                    <property name="connector-ref"/>
                </properties>
            </endpoint>
            <pattern name="Set Payload" type="http://www.mulesoft.org/schema/mule/core/set-payload" entity-id="Set Payload#4">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="value" value="OK"/>
                    <property name="auxiliary;index" value="233"/>
                </properties>
            </pattern>
        </lane>
    </flow>
    <flow SubFlow="true" name="sendemail" entity-id="34a034c2-f1b1-4de1-b497-70208d8f3bcd">
        <properties>
            <property name="processingStrategy"/>
            <property name="processingStrategy2"/>
            <property name="bussinessEventsLabel"/>
            <property name="tracking:enable-default-events"/>
            <property name="auxiliary;index" value="234"/>
        </properties>
        <lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#26">
            <graphicalData x="0" y="0" width="0" height="0"/>
            <endpoint direction="Outbound" message-exchange-pattern="OneWay" name="SMTP" type="http://www.mulesoft.org/schema/mule/smtps/endpoint" entity-id="SMTP#2">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="port"/>
                    <property name="to"/>
                    <property name="host" value="${smtp.host}"/>
                    <property name="businessEventsLabel"/>
                    <property name="subject" value="Error Occured Please Check"/>
                    <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/smtps/endpoint"/>
                    <property name="bcc"/>
                    <property name="from"/>
                    <property name="disableTransportTransformer"/>
                    <property name="password" value="${smtp.password}"/>
                    <property name="tracking:enable-default-events"/>
                    <property name="exchange-pattern" value="one-way"/>
                    <property name="ref"/>
                    <property name="transformer-refs"/>
                    <property name="replyTo"/>
                    <property name="address"/>
                    <property name="encoding"/>
                    <property name="user" value="${smtp.user}"/>
                    <property name="mimeType"/>
                    <property name="responseTimeout"/>
                    <property name="auxiliary;index" value="235"/>
                    <property name="cc"/>
                    <property name="connector-ref" value="smtpsGmailConnector"/>
                </properties>
            </endpoint>
        </lane>
    </flow>
    <flow SubFlow="false" name="processhl7vm" entity-id="70806254-10ac-4566-b300-1349f162f045">
        <properties>
            <property name="processingStrategy"/>
            <property name="processingStrategy2"/>
            <property name="bussinessEventsLabel"/>
            <property name="tracking:enable-default-events"/>
            <property name="auxiliary;index" value="236"/>
        </properties>
        <lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#27">
            <graphicalData x="0" y="0" width="0" height="0"/>
            <endpoint direction="Inbound" message-exchange-pattern="OneWay" name="VM" type="http://www.mulesoft.org/schema/mule/vm/endpoint" entity-id="VM#2">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="businessEventsLabel"/>
                    <property name="disableTransportTransformer"/>
                    <property name="exchange-pattern"/>
                    <property name="tracking:enable-default-events"/>
                    <property name="ref"/>
                    <property name="transformer-refs"/>
                    <property name="address"/>
                    <property name="path" value="processhl7vm"/>
                    <property name="encoding"/>
                    <property name="responseTransformer-refs"/>
                    <property name="auxiliary;index" value="237"/>
                    <property name="responseTimeout"/>
                    <property name="mimeType"/>
                    <property name="connector-ref"/>
                </properties>
            </endpoint>
            <pattern name="Warning Messages" type="http://www.mulesoft.org/schema/mule/core/variable-transformer" entity-id="Variable#17">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="variableName" value="warnings"/>
                    <property name="value" value="#[groovy:new StringBuilder()]"/>
                    <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/core/set-variable"/>
                    <property name="auxiliary;index" value="238"/>
                </properties>
            </pattern>
            <pattern name="Variable" type="http://www.mulesoft.org/schema/mule/core/variable-transformer" entity-id="Variable#18">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="variableName" value="originalhl7"/>
                    <property name="value" value="#[payload:]"/>
                    <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/core/set-variable"/>
                    <property name="auxiliary;index" value="239"/>
                </properties>
            </pattern>
            <scope name="Message Enricher" type="org.mule.tooling.ui.modules.core.scope.enricher" entity-id="Message Enricher#8">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="source" value="#[payload.id]"/>
                    <property name="target" value="#[variable:messageId]"/>
                    <property name="auxiliary;index" value="240"/>
                </properties>
                <compartment entity-id="compartment#18">
                    <lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#28">
                        <pattern name="Flow Reference" type="http://www.mulesoft.org/schema/mule/core/flow-ref" entity-id="Flow Reference#14">
                            <graphicalData x="0" y="0" width="0" height="0"/>
                            <properties>
<property name="name" value="SaveADT"/>
<property name="auxiliary;index" value="241"/>
                            </properties>
                        </pattern>
                    </lane>
                </compartment>
            </scope>
            <pattern name="Processing everything as A01" type="http://www.mulesoft.org/schema/mule/core/set-payload" entity-id="Set Payload#5">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="value" value="#[groovy:payload.replaceAll('\\|ADT\\^A\\d\\d\\|', '|ADT^A01|')]"/>
                    <property name="auxiliary;index" value="242"/>
                </properties>
            </pattern>
            <pattern name="Log NEW" type="http://www.mulesoft.org/schema/mule/core/logger" entity-id="Logger#12">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="message" value="&quot;received from  = &quot; #[payload]"/>
                    <property name="category"/>
                    <property name="level" value="DEBUG"/>
                    <property name="auxiliary;index" value="243"/>
                </properties>
            </pattern>
            <pattern name="Transform A01 to XML" type="http://www.mulesoft.org/schema/mule/hl7/hl7-encoding-transformer" entity-id="HL7 Encoding Transformer#1">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="returnClass"/>
                    <property name="ignoreBadInput"/>
                    <property name="validation"/>
                    <property name="name" value="HL7_Encoding_Transformer"/>
                    <property name="encoding"/>
                    <property name="hl7Encoding" value="XML"/>
                    <property name="mimeType"/>
                    <property name="auxiliary;index" value="244"/>
                </properties>
            </pattern>
            <pattern name="Variable" type="http://www.mulesoft.org/schema/mule/core/variable-transformer" entity-id="Variable#19">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="variableName" value="orginalXML"/>
                    <property name="value" value="#[payload]"/>
                    <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/core/set-variable"/>
                    <property name="auxiliary;index" value="245"/>
                </properties>
            </pattern>
            <pattern name="Variable" type="http://www.mulesoft.org/schema/mule/core/variable-transformer" entity-id="Variable#20">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="variableName" value="eventType"/>
                    <property name="value" value="#[xpath('/hl7xml:ADT_A01/hl7xml:EVN/hl7xml:EVN.1').Text]"/>
                    <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/core/set-variable"/>
                    <property name="auxiliary;index" value="246"/>
                </properties>
            </pattern>
            <pattern name="Variable" type="http://www.mulesoft.org/schema/mule/core/variable-transformer" entity-id="Variable#21">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="variableName" value="controlID"/>
                    <property name="value" value="#[xpath('/hl7xml:ADT_A01/hl7xml:MSH/hl7xml:MSH.10').Text]"/>
                    <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/core/set-variable"/>
                    <property name="auxiliary;index" value="247"/>
                </properties>
            </pattern>
            <pattern name="Log XML original" type="http://www.mulesoft.org/schema/mule/core/logger" entity-id="Logger#13">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="message" value="#[payload]"/>
                    <property name="category"/>
                    <property name="level" value="DEBUG"/>
                    <property name="auxiliary;index" value="248"/>
                </properties>
            </pattern>
            <splitter index="249" name="Choice" type="org.mule.tooling.ui.modules.core.pattern.cbr" entity-id="Choice#13">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property-collection name="328cd43d-8b1b-411e-992c-19268dc163ec">
                        <property name="choice.expression" value="#[groovy:eventType == 'A18' || eventType == 'A38']"/>
                        <property-collection name="choice.attributes">
                            <property name="expression" value="#[groovy:eventType == 'A18' || eventType == 'A38']"/>
                        </property-collection>
                    </property-collection>
                    <property-collection name="b3557865-bc47-4879-b52e-6c49f711141b">
                        <property name="choice.otherwise" value="true"/>
                        <property-collection name="choice.attributes"/>
                    </property-collection>
                </properties>
                <pattern name="Choice" type="org.mule.tooling.ui.modules.core.pattern.cbr" entity-id="Choice#14"/>
                <compartment entity-id="compartment#19">
                    <lane hadOnlyOneElement="false" index="251" isChoiceOtherwiseLane="false" entity-id="328cd43d-8b1b-411e-992c-19268dc163ec">
                        <scope name="Message Enricher" type="org.mule.tooling.ui.modules.core.scope.enricher" entity-id="Message Enricher#9">
                            <graphicalData x="0" y="0" width="0" height="0"/>
                            <properties>
<property name="source"/>
<property name="target" value="variable:dummy1"/>
<property name="auxiliary;index" value="251"/>
                            </properties>
                            <compartment entity-id="compartment#20">
<lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#29">
    <scope name="Processor Chain" type="http://www.mulesoft.org/schema/mule/core/processor-chain" entity-id="Processor Chain#5">
        <graphicalData x="0" y="0" width="0" height="0"/>
        <properties>
            <property name="auxiliary;index" value="252"/>
        </properties>
        <compartment entity-id="compartment#21">
            <lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#30">
                <pattern name="Set Payload" type="http://www.mulesoft.org/schema/mule/core/set-payload" entity-id="Set Payload#6">
                    <graphicalData x="0" y="0" width="0" height="0"/>
                    <properties>
                        <property name="value" value="#[eventType] is not supported yet"/>
                        <property name="auxiliary;index" value="253"/>
                    </properties>
                </pattern>
                <pattern name="Flow Reference" type="http://www.mulesoft.org/schema/mule/core/flow-ref" entity-id="Flow Reference#15">
                    <graphicalData x="0" y="0" width="0" height="0"/>
                    <properties>
                        <property name="name" value="messageUnsupportedLogging"/>
                        <property name="auxiliary;index" value="254"/>
                    </properties>
                    <description>logging</description>
                </pattern>
            </lane>
        </compartment>
    </scope>
</lane>
                            </compartment>
                        </scope>
                        <pattern name="Set Payload" type="http://www.mulesoft.org/schema/mule/core/set-payload" entity-id="Set Payload#7">
                            <graphicalData x="0" y="0" width="0" height="0"/>
                            <properties>
<property name="value" value="#[originalhl7]"/>
<property name="auxiliary;index" value="255"/>
                            </properties>
                        </pattern>
                        <pattern name="HL7 ACK" type="http://www.mulesoft.org/schema/mule/hl7/ack-component" entity-id="HL7 ACK#1">
                            <graphicalData x="0" y="0" width="0" height="0"/>
                            <properties>
<property name="ackCode" value="AA"/>
<property name="validation"/>
<property name="auxiliary;index" value="256"/>
                            </properties>
                        </pattern>
                    </lane>
                    <lane hadOnlyOneElement="false" index="258" isChoiceOtherwiseLane="true" entity-id="b3557865-bc47-4879-b52e-6c49f711141b">
                        <scope name="Enricher PatientFlow" type="org.mule.tooling.ui.modules.core.scope.enricher" entity-id="Message Enricher#10">
                            <graphicalData x="0" y="0" width="0" height="0"/>
                            <properties>
<property name="source"/>
<property name="target"/>
<property name="auxiliary;index" value="258"/>
<property-collection name="@http://www.mulesoft.org/schema/mule/core/enrich;0">
    <property name="source" value="#[flowVars.?pId]"/>
    <property name="target" value="#[flowVars['pId']]"/>
    <property name="auxiliary;index" value="260"/>
    <property name="auxiliary;wrapIn" value="260"/>
</property-collection>
<property-collection name="@http://www.mulesoft.org/schema/mule/core/enrich;1">
    <property name="source" value="#[flowVars.?savedPatient]"/>
    <property name="target" value="#[flowVars['savedPatient']]"/>
    <property name="auxiliary;index" value="261"/>
    <property name="auxiliary;wrapIn" value="261"/>
</property-collection>
<property-collection name="@http://www.mulesoft.org/schema/mule/core/enrich;2">
    <property name="source" value="#[flowVars.?mappedPatient]"/>
    <property name="target" value="#[flowVars['mappedPatient']]"/>
    <property name="auxiliary;index" value="262"/>
    <property name="auxiliary;wrapIn" value="262"/>
</property-collection>
<property-collection name="@http://www.mulesoft.org/schema/mule/core/enrich;3">
    <property name="source" value="#[flowVars.?saveInpatientRoles]"/>
    <property name="target" value="#[flowVars['saveInpatientRoles']]"/>
    <property name="auxiliary;index" value="263"/>
    <property name="auxiliary;wrapIn" value="263"/>
</property-collection>
                            </properties>
                            <compartment entity-id="compartment#22">
<lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#31">
    <pattern name="Insert Patient Flow" type="http://www.mulesoft.org/schema/mule/core/flow-ref" entity-id="Flow Reference#16">
        <graphicalData x="0" y="0" width="0" height="0"/>
        <properties>
            <property name="name" value="mule-ucsf-insert-patient"/>
            <property name="auxiliary;index" value="259"/>
        </properties>
    </pattern>
</lane>
                            </compartment>
                        </scope>
                        <splitter index="264" name="Choice" type="org.mule.tooling.ui.modules.core.pattern.cbr" entity-id="Choice#15">
                            <graphicalData x="0" y="0" width="0" height="0"/>
                            <properties>
<property-collection name="2b727422-a479-42c1-9088-a13e57a5c80f">
    <property name="choice.otherwise" value="true"/>
    <property-collection name="choice.attributes"/>
</property-collection>
<property-collection name="6dc6e358-3740-4ec2-a073-ff5fa14fefee">
    <property name="choice.expression" value="#[pId instanceof NullPayload]"/>
    <property-collection name="choice.attributes">
        <property name="expression" value="#[pId instanceof NullPayload]"/>
    </property-collection>
</property-collection>
                            </properties>
                            <pattern name="Choice" type="org.mule.tooling.ui.modules.core.pattern.cbr" entity-id="Choice#16"/>
                            <compartment entity-id="compartment#23">
<lane hadOnlyOneElement="false" index="266" isChoiceOtherwiseLane="false" entity-id="6dc6e358-3740-4ec2-a073-ff5fa14fefee">
    <pattern name="Set Payload" type="http://www.mulesoft.org/schema/mule/core/set-payload" entity-id="Set Payload#8">
        <graphicalData x="0" y="0" width="0" height="0"/>
        <properties>
            <property name="value" value="&quot;Failed&quot;"/>
            <property name="auxiliary;index" value="266"/>
        </properties>
    </pattern>
</lane>
<lane hadOnlyOneElement="false" index="268" isChoiceOtherwiseLane="true" entity-id="2b727422-a479-42c1-9088-a13e57a5c80f">
    <pattern name="Set Payload" type="http://www.mulesoft.org/schema/mule/core/set-payload" entity-id="Set Payload#9">
        <graphicalData x="0" y="0" width="0" height="0"/>
        <properties>
            <property name="value" value="&quot;Success&quot;"/>
            <property name="auxiliary;index" value="268"/>
        </properties>
    </pattern>
</lane>
                            </compartment>
                        </splitter>
                        <pattern name="Byte Array to String" type="http://www.mulesoft.org/schema/mule/core/byte-array-to-string-transformer" entity-id="Byte Array to String#4">
                            <graphicalData x="0" y="0" width="0" height="0"/>
                            <properties>
<property name="returnClass"/>
<property name="ignoreBadInput"/>
<property name="encoding"/>
<property name="mimeType"/>
<property name="auxiliary;index" value="269"/>
                            </properties>
                        </pattern>
                        <pattern name="Flow Reference" type="http://www.mulesoft.org/schema/mule/core/flow-ref" entity-id="Flow Reference#17">
                            <graphicalData x="0" y="0" width="0" height="0"/>
                            <properties>
<property name="name" value="updateSalesforce"/>
<property name="auxiliary;index" value="270"/>
                            </properties>
                        </pattern>
                        <pattern name="Set Payload" type="http://www.mulesoft.org/schema/mule/core/set-payload" entity-id="Set Payload#10">
                            <graphicalData x="0" y="0" width="0" height="0"/>
                            <properties>
<property name="value" value="#[originalhl7]"/>
<property name="auxiliary;index" value="271"/>
                            </properties>
                        </pattern>
                        <pattern name="HL7 ACK" type="http://www.mulesoft.org/schema/mule/hl7/ack-component" entity-id="HL7 ACK#2">
                            <graphicalData x="0" y="0" width="0" height="0"/>
                            <properties>
<property name="ackCode" value="AA"/>
<property name="validation"/>
<property name="auxiliary;index" value="272"/>
                            </properties>
                        </pattern>
                    </lane>
                </compartment>
            </splitter>
            <pattern name="Logger" type="http://www.mulesoft.org/schema/mule/core/logger" entity-id="Logger#14">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="message" value="Payload is: #[payload]"/>
                    <property name="category"/>
                    <property name="level" value="INFO"/>
                    <property name="auxiliary;index" value="273"/>
                </properties>
            </pattern>
            <endpoint direction="Outbound" message-exchange-pattern="OneWay" name="VM" type="http://www.mulesoft.org/schema/mule/vm/endpoint" entity-id="VM#3">
                <graphicalData x="0" y="0" width="0" height="0"/>
                <properties>
                    <property name="businessEventsLabel"/>
                    <property name="disableTransportTransformer"/>
                    <property name="exchange-pattern"/>
                    <property name="tracking:enable-default-events"/>
                    <property name="ref"/>
                    <property name="transformer-refs"/>
                    <property name="address"/>
                    <property name="path" value="reply"/>
                    <property name="encoding"/>
                    <property name="responseTransformer-refs"/>
                    <property name="auxiliary;index" value="274"/>
                    <property name="responseTimeout"/>
                    <property name="mimeType"/>
                    <property name="connector-ref"/>
                </properties>
            </endpoint>
            <scope name="Catch Exception Strategy" type="http://www.mulesoft.org/schema/mule/core/catch-exception-strategy" entity-id="Catch Exception Strategy#2">
                <properties>
                    <property name="labelConfigureConditionalExecutionUsingExpression"/>
                    <property name="when"/>
                    <property name="enableNotifications"/>
                    <property name="auxiliary;index" value="275"/>
                </properties>
                <compartment entity-id="compartment#24">
                    <lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#32">
                        <pattern name="Set Payload" type="http://www.mulesoft.org/schema/mule/core/set-payload" entity-id="Set Payload#11">
                            <graphicalData x="0" y="0" width="0" height="0"/>
                            <properties>
<property name="value" value="#[originalhl7]"/>
<property name="auxiliary;index" value="276"/>
                            </properties>
                        </pattern>
                        <splitter index="277" name="Choice" type="org.mule.tooling.ui.modules.core.pattern.cbr" entity-id="Choice#17">
                            <graphicalData x="0" y="0" width="0" height="0"/>
                            <properties>
<property-collection name="1a1504f7-dde5-467f-9711-eae0ed5431a6">
    <property name="choice.expression" value="flowVars['hasEnteredThisBefore'] != null"/>
    <property-collection name="choice.attributes">
        <property name="expression" value="flowVars['hasEnteredThisBefore'] != null"/>
    </property-collection>
</property-collection>
<property-collection name="b806d680-eaf3-4dea-b685-618c3b816160">
    <property name="choice.otherwise" value="true"/>
    <property-collection name="choice.attributes"/>
</property-collection>
                            </properties>
                            <pattern name="Choice" type="org.mule.tooling.ui.modules.core.pattern.cbr" entity-id="Choice#18"/>
                            <compartment entity-id="compartment#25">
<lane hadOnlyOneElement="false" index="279" isChoiceOtherwiseLane="false" entity-id="1a1504f7-dde5-467f-9711-eae0ed5431a6">
    <pattern name="HL7 ACK" type="http://www.mulesoft.org/schema/mule/hl7/ack-component" entity-id="HL7 ACK#3">
        <graphicalData x="0" y="0" width="0" height="0"/>
        <properties>
            <property name="ackCode" value="AE"/>
            <property name="validation"/>
            <property name="auxiliary;index" value="279"/>
        </properties>
    </pattern>
    <endpoint direction="Outbound" message-exchange-pattern="OneWay" name="VM" type="http://www.mulesoft.org/schema/mule/vm/endpoint" entity-id="VM#4">
        <graphicalData x="0" y="0" width="0" height="0"/>
        <properties>
            <property name="businessEventsLabel"/>
            <property name="disableTransportTransformer"/>
            <property name="exchange-pattern"/>
            <property name="tracking:enable-default-events"/>
            <property name="ref"/>
            <property name="transformer-refs"/>
            <property name="address"/>
            <property name="path" value="reply"/>
            <property name="encoding"/>
            <property name="responseTransformer-refs"/>
            <property name="auxiliary;index" value="280"/>
            <property name="responseTimeout"/>
            <property name="mimeType"/>
            <property name="connector-ref"/>
        </properties>
    </endpoint>
    <pattern name="Logger" type="http://www.mulesoft.org/schema/mule/core/logger" entity-id="Logger#15">
        <graphicalData x="0" y="0" width="0" height="0"/>
        <properties>
            <property name="message" value="sending error ack #[payload:]"/>
            <property name="category"/>
            <property name="level"/>
            <property name="auxiliary;index" value="281"/>
        </properties>
    </pattern>
</lane>
<lane hadOnlyOneElement="false" index="283" isChoiceOtherwiseLane="true" entity-id="b806d680-eaf3-4dea-b685-618c3b816160">
    <scope name="Processor Chain" type="http://www.mulesoft.org/schema/mule/core/processor-chain" entity-id="Processor Chain#6">
        <graphicalData x="0" y="0" width="0" height="0"/>
        <properties>
            <property name="auxiliary;index" value="283"/>
        </properties>
        <compartment entity-id="compartment#26">
            <lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#33">
                <pattern name="Set Payload" type="http://www.mulesoft.org/schema/mule/core/set-payload" entity-id="Set Payload#12">
                    <graphicalData x="0" y="0" width="0" height="0"/>
                    <properties>
                        <property name="value" value="#[originalhl7]"/>
                        <property name="auxiliary;index" value="284"/>
                    </properties>
                </pattern>
                <pattern name="Session Variable" type="http://www.mulesoft.org/schema/mule/core/variable-transformer" entity-id="Variable#22">
                    <graphicalData x="0" y="0" width="0" height="0"/>
                    <properties>
                        <property name="variableName" value="hasEnteredThisBefore"/>
                        <property name="value" value="&quot;yes&quot;"/>
                        <property name="org.mule.tooling.ui.modules.core.widgets.meta.ModeAttribute" value="http://www.mulesoft.org/schema/mule/core/set-variable"/>
                        <property name="auxiliary;index" value="285"/>
                    </properties>
                </pattern>
                <pattern name="Logger" type="http://www.mulesoft.org/schema/mule/core/logger" entity-id="Logger#16">
                    <graphicalData x="0" y="0" width="0" height="0"/>
                    <properties>
                        <property name="message" value="Payload is: #[payload]"/>
                        <property name="category"/>
                        <property name="level" value="ERROR"/>
                        <property name="auxiliary;index" value="286"/>
                    </properties>
                </pattern>
                <splitter index="287" name="Choice" type="org.mule.tooling.ui.modules.core.pattern.cbr" entity-id="Choice#19">
                    <graphicalData x="0" y="0" width="0" height="0"/>
                    <properties>
                        <property-collection name="106aa005-2f28-461d-8a64-40b597d1a75b">
                            <property name="choice.otherwise" value="true"/>
                            <property-collection name="choice.attributes"/>
                        </property-collection>
                        <property-collection name="a4437ec9-49fc-430d-a785-38b044dbef7c">
                            <property name="choice.expression" value="flowVars['messageId'] != null"/>
                            <property-collection name="choice.attributes">
<property name="expression" value="flowVars['messageId'] != null"/>
                            </property-collection>
                        </property-collection>
                    </properties>
                    <pattern name="Choice" type="org.mule.tooling.ui.modules.core.pattern.cbr" entity-id="Choice#20"/>
                    <compartment entity-id="compartment#27">
                        <lane hadOnlyOneElement="false" index="289" isChoiceOtherwiseLane="false" entity-id="a4437ec9-49fc-430d-a785-38b044dbef7c">
                            <pattern name="Custom Business event" type="http://www.mulesoft.org/schema/mule/ee/tracking/custom-event" entity-id="Custom Business event#1">
<graphicalData x="0" y="0" width="0" height="0"/>
<properties>
    <property name="event-name" value="Rejected Message"/>
    <property name="auxiliary;index" value="289"/>
    <property-collection name="@http://www.mulesoft.org/schema/mule/ee/tracking/meta-data;0">
        <property name="value" value="#[message.id]"/>
        <property name="key" value="Message id"/>
        <property name="auxiliary;index" value="290"/>
        <property name="auxiliary;wrapIn" value="290"/>
    </property-collection>
    <property-collection name="@http://www.mulesoft.org/schema/mule/ee/tracking/meta-data;1">
        <property name="value" value="#[payload]"/>
        <property name="key" value="Payload"/>
        <property name="auxiliary;index" value="291"/>
        <property name="auxiliary;wrapIn" value="291"/>
    </property-collection>
    <property-collection name="@http://www.mulesoft.org/schema/mule/ee/tracking/meta-data;2">
        <property name="value" value="#[exception]"/>
        <property name="key" value="ExceptionMessage"/>
        <property name="auxiliary;index" value="292"/>
        <property name="auxiliary;wrapIn" value="292"/>
    </property-collection>
</properties>
                            </pattern>
                            <scope name="Message Enricher" type="org.mule.tooling.ui.modules.core.scope.enricher" entity-id="Message Enricher#11">
<graphicalData x="0" y="0" width="0" height="0"/>
<properties>
    <property name="source"/>
    <property name="target" value="variable:dummy"/>
    <property name="auxiliary;index" value="293"/>
</properties>
<compartment entity-id="compartment#28">
    <lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#34">
        <pattern name="Flow Reference" type="http://www.mulesoft.org/schema/mule/core/flow-ref" entity-id="Flow Reference#18">
            <graphicalData x="0" y="0" width="0" height="0"/>
            <properties>
                <property name="name" value="messageErrorLogging"/>
                <property name="auxiliary;index" value="294"/>
            </properties>
        </pattern>
    </lane>
</compartment>
                            </scope>
                        </lane>
                        <lane hadOnlyOneElement="false" index="296" isChoiceOtherwiseLane="true" entity-id="106aa005-2f28-461d-8a64-40b597d1a75b">
                            <pattern name="Logger" type="http://www.mulesoft.org/schema/mule/core/logger" entity-id="Logger#17">
<graphicalData x="0" y="0" width="0" height="0"/>
<properties>
    <property name="message" value="Salesforce Connection error might have occoured"/>
    <property name="category"/>
    <property name="level" value="ERROR"/>
    <property name="auxiliary;index" value="296"/>
</properties>
                            </pattern>
                        </lane>
                    </compartment>
                </splitter>
                <pattern name="Logger" type="http://www.mulesoft.org/schema/mule/core/logger" entity-id="Logger#18">
                    <graphicalData x="0" y="0" width="0" height="0"/>
                    <properties>
                        <property name="message" value="Sending email"/>
                        <property name="category"/>
                        <property name="level" value="INFO"/>
                        <property name="auxiliary;index" value="297"/>
                    </properties>
                </pattern>
                <scope name="Message Enricher" type="org.mule.tooling.ui.modules.core.scope.enricher" entity-id="Message Enricher#12">
                    <graphicalData x="0" y="0" width="0" height="0"/>
                    <properties>
                        <property name="source"/>
                        <property name="target" value="variable:dummy1"/>
                        <property name="auxiliary;index" value="298"/>
                    </properties>
                    <compartment entity-id="compartment#29">
                        <lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#35">
                            <scope name="Processor Chain" type="http://www.mulesoft.org/schema/mule/core/processor-chain" entity-id="Processor Chain#7">
<graphicalData x="0" y="0" width="0" height="0"/>
<properties>
    <property name="auxiliary;index" value="299"/>
</properties>
<compartment entity-id="compartment#30">
    <lane hadOnlyOneElement="false" index="0" isChoiceOtherwiseLane="false" entity-id="compartment-lane#36">
        <pattern name="Set Payload Error Message" type="http://www.mulesoft.org/schema/mule/core/set-payload" entity-id="Set Payload#13">
            <graphicalData x="0" y="0" width="0" height="0"/>
            <properties>
                <property name="value" value="Error processing HL7 document #[exception]"/>
                <property name="auxiliary;index" value="300"/>
            </properties>
        </pattern>
        <pattern name="Flow Reference" type="http://www.mulesoft.org/schema/mule/core/flow-ref" entity-id="Flow Reference#19">
            <graphicalData x="0" y="0" width="0" height="0"/>
            <properties>
                <property name="name" value="sendemail"/>
                <property name="auxiliary;index" value="301"/>
            </properties>
        </pattern>
    </lane>
</compartment>
                            </scope>
                        </lane>
                    </compartment>
                </scope>
                <splitter index="302" name="Choice" type="org.mule.tooling.ui.modules.core.pattern.cbr" entity-id="Choice#21">
                    <graphicalData x="0" y="0" width="0" height="0"/>
                    <properties>
                        <property-collection name="474cb2c4-c5d9-4b5a-8f88-135d5901060e">
                            <property name="choice.expression" value="#[exception.causedBy(org.mule.api.expression.ExpressionRuntimeException)]"/>
                            <property-collection name="choice.attributes">
<property name="expression" value="#[exception.causedBy(org.mule.api.expression.ExpressionRuntimeException)]"/>
                            </property-collection>
                        </property-collection>
                        <property-collection name="8d88db52-084c-4f56-8703-9c047cc694cc">
                            <property name="choice.expression" value="#[exception.causedBy(org.mule.api.ConnectionException)]"/>
                            <property-collection name="choice.attributes">
<property name="expression" value="#[exception.causedBy(org.mule.api.ConnectionException)]"/>
                            </property-collection>
                        </property-collection>
                        <property-collection name="e84bce5d-e112-4f9b-95e5-c50beb7a885d">
                            <property name="choice.otherwise" value="true"/>
                            <property-collection name="choice.attributes"/>
                        </property-collection>
                    </properties>
                    <pattern name="Choice" type="org.mule.tooling.ui.modules.core.pattern.cbr" entity-id="Choice#22"/>
                    <compartment entity-id="compartment#31">
                        <lane hadOnlyOneElement="false" index="304" isChoiceOtherwiseLane="false" entity-id="8d88db52-084c-4f56-8703-9c047cc694cc">
                            <pattern name="Logger" type="http://www.mulesoft.org/schema/mule/core/logger" entity-id="Logger#19">
<graphicalData x="0" y="0" width="0" height="0"/>
<properties>
    <property name="message" value="NOT creating any log and replying to the main thread as cloverleaf is setup to retry only if it does not get anything back"/>
    <property name="category"/>
    <property name="level" value="ERROR"/>
    <property name="auxiliary;index" value="304"/>
</properties>
                            </pattern>
                        </lane>
                        <lane hadOnlyOneElement="false" index="306" isChoiceOtherwiseLane="false" entity-id="474cb2c4-c5d9-4b5a-8f88-135d5901060e">
                            <pattern name="HL7 ACK" type="http://www.mulesoft.org/schema/mule/hl7/ack-component" entity-id="HL7 ACK#4">
<graphicalData x="0" y="0" width="0" height="0"/>
<properties>
    <property name="ackCode" value="AE"/>
    <property name="validation"/>
    <property name="auxiliary;index" value="306"/>
</properties>
                            </pattern>
                            <endpoint direction="Outbound" message-exchange-pattern="OneWay" name="VM" type="http://www.mulesoft.org/schema/mule/vm/endpoint" entity-id="VM#5">
<graphicalData x="0" y="0" width="0" height="0"/>
<properties>
    <property name="businessEventsLabel"/>
    <property name="disableTransportTransformer"/>
    <property name="exchange-pattern"/>
    <property name="tracking:enable-default-events"/>
    <property name="ref"/>
    <property name="transformer-refs"/>
    <property name="address"/>
    <property name="path" value="reply"/>
    <property name="encoding"/>
    <property name="responseTransformer-refs"/>
    <property name="auxiliary;index" value="307"/>
    <property name="responseTimeout"/>
    <property name="mimeType"/>
    <property name="connector-ref"/>
</properties>
                            </endpoint>
                        </lane>
                        <lane hadOnlyOneElement="false" index="309" isChoiceOtherwiseLane="true" entity-id="e84bce5d-e112-4f9b-95e5-c50beb7a885d">
                            <pattern name="HL7 ACK" type="http://www.mulesoft.org/schema/mule/hl7/ack-component" entity-id="HL7 ACK#5">
<graphicalData x="0" y="0" width="0" height="0"/>
<properties>
    <property name="ackCode" value="AR"/>
    <property name="validation"/>
    <property name="auxiliary;index" value="309"/>
</properties>
                            </pattern>
                            <endpoint direction="Outbound" message-exchange-pattern="OneWay" name="VM" type="http://www.mulesoft.org/schema/mule/vm/endpoint" entity-id="VM#6">
<graphicalData x="0" y="0" width="0" height="0"/>
<properties>
    <property name="businessEventsLabel"/>
    <property name="disableTransportTransformer"/>
    <property name="exchange-pattern"/>
    <property name="tracking:enable-default-events"/>
    <property name="ref"/>
    <property name="transformer-refs"/>
    <property name="address"/>
    <property name="path" value="reply"/>
    <property name="encoding"/>
    <property name="responseTransformer-refs"/>
    <property name="auxiliary;index" value="310"/>
    <property name="responseTimeout"/>
    <property name="mimeType"/>
    <property name="connector-ref"/>
</properties>
                            </endpoint>
                        </lane>
                    </compartment>
                </splitter>
                <pattern name="Logger" type="http://www.mulesoft.org/schema/mule/core/logger" entity-id="Logger#20">
                    <graphicalData x="0" y="0" width="0" height="0"/>
                    <properties>
                        <property name="message" value="ACK Payload #[payload]"/>
                        <property name="category"/>
                        <property name="level" value="INFO"/>
                        <property name="auxiliary;index" value="311"/>
                    </properties>
                </pattern>
                <pattern name="Logger" type="http://www.mulesoft.org/schema/mule/core/logger" entity-id="Logger#21">
                    <graphicalData x="0" y="0" width="0" height="0"/>
                    <properties>
                        <property name="message" value=" Warnings during processing #[warnings]"/>
                        <property name="category"/>
                        <property name="level" value="WARN"/>
                        <property name="auxiliary;index" value="312"/>
                    </properties>
                </pattern>
            </lane>
        </compartment>
    </scope>
</lane>
                            </compartment>
                        </splitter>
                    </lane>
                </compartment>
            </scope>
        </lane>
    </flow>
</mule-configuration>
